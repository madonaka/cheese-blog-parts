<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ë¸”ë¡œê·¸ ë„êµ¬ Â· ì½”ë“œ ìƒì„±ê¸°</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="./admin.css" />
  <style>
    body{ margin:0; background:#f3f4f6; font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif; color:#0f172a; }
    .wrap{ max-width:1100px; margin:0 auto; padding:18px 18px 28px; box-sizing:border-box; }
    .card{ background:#fff; border:1px solid rgba(15,23,42,.10); border-radius:18px; box-shadow:0 10px 28px rgba(15,23,42,.10); overflow:hidden; margin-bottom:14px; }
    .h{ padding:14px 14px 10px; border-bottom:1px solid rgba(15,23,42,.06); display:flex; gap:10px; align-items:center; justify-content:space-between; flex-wrap:wrap; }
    .t{ font-weight:1000; letter-spacing:-0.02em; }
    .s{ color:#475569; font-size:12px; font-weight:650; }
    .b{ padding:14px; }
    .tabs{ display:flex; gap:8px; flex-wrap:wrap; }
    .tab{ border:1px solid rgba(15,23,42,.14); background:#fff; border-radius:999px; padding:8px 12px; font-weight:900; cursor:pointer; }
    .tab.on{ background:rgba(15,23,42,.92); color:#fff; border-color:rgba(15,23,42,.92); }
    .grid{ display:grid; grid-template-columns: 1fr 1fr; gap:12px; }
    @media (max-width:900px){ .grid{ grid-template-columns:1fr; } }

    label{ font-size:12px; color:#475569; font-weight:900; }
    .field{ display:flex; flex-direction:column; gap:8px; }
    .input, .ta{
      border:1px solid rgba(15,23,42,.14); border-radius:12px; padding:10px 12px;
      font-size:13px; font-weight:650; outline:none; background:#fff;
    }
    .ta{ min-height:220px; resize:vertical; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
    .ta.out{ min-height:320px; }
    .btns{ display:flex; gap:8px; flex-wrap:wrap; justify-content:flex-end; margin-top:10px; }
    .btn{
      border:1px solid rgba(15,23,42,.14); background:#fff; border-radius:12px;
      padding:10px 12px; font-size:13px; font-weight:900; cursor:pointer;
    }
    .btn.primary{ background:rgba(15,23,42,.92); color:#fff; border-color:rgba(15,23,42,.92); }
    .hint{ font-size:12px; color:#475569; font-weight:650; }
    .err{ color:#b91c1c; font-weight:900; }
    .ok{ color:#15803d; font-weight:900; }
    .row2{ grid-column: 1 / -1; }
    .hide{ display:none; }
    .rows { display:flex; flex-direction:column; gap:.5rem; margin:.6rem 0; }
    .row  { display:flex; gap:.5rem; align-items:center; }
    .row input { flex:1; padding:.55rem .7rem; border:1px solid #e5e7eb; border-radius:10px; }
    .row .mini { padding:.5rem .7rem; border-radius:10px; border:1px solid #e5e7eb; background:#fff; cursor:pointer; }
    .row-head { display:flex; justify-content:flex-end; margin-top:.25rem; }
  </style>
</head>
<body>
  <div class="admin-shell">
    <div id="admin-header-slot"></div>
    <div class="admin-main">
      <aside id="admin-menu-slot" class="admin-sidebar"></aside>

      <main class="wrap">
        <div class="card">
          <div class="h">
            <div>
              <div class="t">ë¸”ë¡œê·¸ ì½”ë“œ ìƒì„±ê¸°</div>
              <div class="s">ê°’ë§Œ ë„£ê³  â€œìƒì„±â€ â†’ â€œë³µì‚¬â€ â†’ ë¸”ë¡œê·¸ HTMLì— ë¶™ì—¬ë„£ê¸°</div>
            </div>
            <div class="tabs">
              <button class="tab on" id="tabFlash" type="button">í”Œë˜ì‹œì¹´ë“œ</button>
              <button class="tab" id="tabOrder" type="button">ë“œë˜ê·¸ ì •ë ¬</button>
            </div>
          </div>

          <div class="b">
            <!-- Flashcard -->
            <section id="secFlash">
              <div class="grid">
                <div class="field">
                  <label>ì¹´ë“œ ë°ì´í„° (ì¤„ ë‹¨ìœ„)</label>
                  <div class="row-head">
                    <button type="button" class="btn secondary" id="fcAdd">+ ì¹´ë“œ ì¶”ê°€</button>
                  </div>
                  <div id="fcRows" class="rows"></div>
sovereignty\tì£¼ê¶Œ
annexation | ë³‘í•©, í•©ë³‘
protectorate => ë³´í˜¸êµ­"></textarea>
                  <div class="hint">êµ¬ë¶„ì: TAB / | / =&gt; ì¤‘ ì•„ë¬´ê±°ë‚˜. ë¹ˆ ì¤„ì€ ë¬´ì‹œ.</div>
                </div>

                <div class="field">
                  <label>ì¶œë ¥</label>
                  <textarea class="ta out" id="out" readonly></textarea>
                  <div class="hint" id="msg"></div>
                </div>

                <div class="field row2">
                  <div class="btns">
                    <button class="btn" id="btnClear" type="button">ë¹„ìš°ê¸°</button>
                    <button class="btn primary" id="btnGen" type="button">ìƒì„±</button>
                    <button class="btn" id="btnCopy" type="button">ë³µì‚¬</button>
                  </div>
                </div>
              </div>
            </section>

            <!-- Order -->
            <section id="secOrder" class="hide">
              <div class="grid">
                <div class="field">
                  <label>ì œëª©(ì˜µì…˜)</label>
                  <input class="input" id="oqTitle" placeholder="ì‹œëŒ€ ìˆœì„œë¥¼ ë§ì¶° ë³´ì„¸ìš”" />
                </div>
                <div class="field">
                  <label>ì„¤ëª…(ì˜µì…˜)</label>
                  <input class="input" id="oqSub" placeholder="ì¹´ë“œë¥¼ ì•„ë˜ ìˆœì„œ ì˜ì—­ìœ¼ë¡œ ë“œë˜ê·¸í•´ì„œ ì˜®ê²¨ ë³´ì„¸ìš”." />
                </div>

                <div class="field">
                  <label>ë³´ê¸° í•­ëª© (ì¤„ ë‹¨ìœ„)</label>
                  <div class="row-head">
                    <button type="button" class="btn secondary" id="oqAdd">+ í•­ëª© ì¶”ê°€</button>
                  </div>
                  <div id="oqRows" class="rows"></div>
                  <div class="hint">ì¤„ ìˆœì„œê°€ â€œë³´ê¸°â€ ìˆœì„œê°€ ë¨</div>
                </div>

                <div class="field">
                  <label>ì •ë‹µ ìˆœì„œ (ìˆ«ì, ì‰¼í‘œ)</label>
                  <input class="input" id="oqOrder" placeholder="1,2,3,4" />
                  <div class="hint">ì˜ˆ: 2,1,4,3 (ê° ìˆ«ìëŠ” ë³´ê¸° í•­ëª©ì˜ ì¤„ ë²ˆí˜¸)</div>
                </div>

                <div class="field">
                  <label>ì¶œë ¥</label>
                  <textarea class="ta out" id="out2" readonly></textarea>
                  <div class="hint" id="msg2"></div>
                </div>

                <div class="field row2">
                  <div class="btns">
                    <button class="btn" id="btnClear2" type="button">ë¹„ìš°ê¸°</button>
                    <button class="btn primary" id="btnGen2" type="button">ìƒì„±</button>
                    <button class="btn" id="btnCopy2" type="button">ë³µì‚¬</button>
                  </div>
                </div>
              </div>
            </section>

          </div>
        </div>
      </main>
    </div>
  </div>

  <script src="./admin-common.js"></script>
  <script>
    // (ì„ íƒ) ë„ˆì˜ ê¸°ì¡´ í—¤ë”/ë©”ë‰´ ë§ˆìš´íŠ¸ í•¨ìˆ˜ê°€ ìˆìœ¼ë©´ ìë™ìœ¼ë¡œ ë¶™ìŒ
    (function mountShell(){
      const tryCall = (names, args)=>{
        for(const n of names){
          if(typeof window[n] === 'function'){
            try{ window[n](args); }catch(e){ console.warn(n,e); }
            return true;
          }
        }
        return false;
      };
      tryCall(['renderAdminHeader','mountAdminHeader'], { mountId:'admin-header-slot', badgeText:'blog', subtitle:'ì½”ë“œ ìƒì„±ê¸°' });
      tryCall(['renderAdminMenu','renderAdminSidebar','mountAdminMenu'], { mountId:'admin-menu-slot', active:'blog' });
    })();

    // ---------- helpers ----------
    const $ = (id)=>document.getElementById(id);

    function setMsg(el, text, ok){
      el.textContent = text || '';
      el.className = 'hint ' + (ok ? 'ok' : (text ? 'err' : ''));
    }

    function uid_(){
      return Math.random().toString(36).slice(2, 8);
    }

    function parsePairs_(text){
      const lines = String(text||'').split(/\r?\n/).map(s=>s.trim()).filter(Boolean);
      const pairs = [];
      for(const line of lines){
        // TAB ìš°ì„ 
        let a='', b='';
        if(line.includes('\t')){
          const p = line.split('\t');
          a = (p[0]||'').trim(); b = (p.slice(1).join('\t')||'').trim();
        }else if(line.includes('=>')){
          const p = line.split('=>');
          a = (p[0]||'').trim(); b = (p.slice(1).join('=>')||'').trim();
        }else if(line.includes('|')){
          const p = line.split('|');
          a = (p[0]||'').trim(); b = (p.slice(1).join('|')||'').trim();
        }else{
          // êµ¬ë¶„ì ì—†ìœ¼ë©´ ì‹¤íŒ¨
          a = line.trim(); b = '';
        }
        if(!a || !b) continue;
        pairs.push({ front:a, back:b });
      }
      return pairs;
    }

    function parseOrderNums_(text, n){
      const nums = String(text||'')
        .split(',')
        .map(s=>s.trim())
        .filter(Boolean)
        .map(s=>Number(s));

      if(nums.length !== n) return { ok:false, msg:`ì •ë‹µ ìˆœì„œ ìˆ«ì ê°œìˆ˜(${nums.length})ê°€ ë³´ê¸° í•­ëª©(${n})ê³¼ ë‹¬ë¼ìš”.` };

      for(const x of nums){
        if(!Number.isInteger(x) || x < 1 || x > n) return { ok:false, msg:`ì •ë‹µ ìˆœì„œì— 1~${n} ë²”ìœ„ ë°– ìˆ«ìê°€ ìˆì–´ìš”: ${x}` };
      }
      // ì¤‘ë³µ ì²´í¬
      const set = new Set(nums);
      if(set.size !== nums.length) return { ok:false, msg:`ì •ë‹µ ìˆœì„œì— ì¤‘ë³µ ìˆ«ìê°€ ìˆì–´ìš”.` };

      return { ok:true, nums };
    }

    async function copy_(text){
      try{
        await navigator.clipboard.writeText(text);
        return true;
      }catch(e){
        // fallback
        const ta = document.createElement('textarea');
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        try{ document.execCommand('copy'); }catch(_){}
        document.body.removeChild(ta);
        return true;
      }
    }

    // ---------- templates (ì£¼ì˜: </script>ëŠ” <\/script>ë¡œ) ----------
    function buildFlashcardSnippet_(cards){
      const id = 'cheese-flashcard-root-' + uid_();
      const data = JSON.stringify(cards);

      return `<!-- â–¼ ì¹´ë“œê°€ í‘œì‹œë  ìë¦¬ -->
<div id="${id}" class="cheese-flashcard-wrapper"></div>

<style>
  .cheese-flashcard-wrapper {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1.5rem;
    margin: 1.5rem 0;
  }
  .cheese-flashcard {
    background: none;
    border: none;
    padding: 0;
    width: 380px;
    height: 230px;
    perspective: 1000px;
    cursor: pointer;
    position: relative;
    border-radius: 22px;
    overflow: hidden;
    box-shadow: 0 14px 30px rgba(15, 23, 42, 0.2);
  }
  .cheese-flashcard.is-flipped .cheese-flashcard-inner { transform: rotateY(180deg); }
  .cheese-flashcard-inner {
    width: 100%;
    height: 100%;
    position: relative;
    border-radius: 22px;
    box-shadow: 0 14px 30px rgba(15, 23, 42, 0.2);
    background: #ffffff;
    transform-style: preserve-3d;
    transition: transform 0.4s ease;
  }
  .cheese-flashcard-face {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 1.4rem 1.8rem;
    box-sizing: border-box;
    backface-visibility: hidden;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    font-size: 1.4rem;
    text-align: center;
    line-height: 1.5;
    border-radius: 22px;
  }
  .cheese-flashcard-front {
    background: #111827;
    color: #f9fafb;
    font-weight: 700;
  }
  .cheese-flashcard-back {
    background: #e0f2fe;
    color: #111827;
    transform: rotateY(180deg);
  }
  .cheese-flashcard-main { font-size: 1.7rem; font-weight: 700; }
  .cheese-flashcard-hint {
    position: absolute;
    right: 0.9rem;
    bottom: 0.6rem;
    font-size: 0.75rem;
    opacity: 0.8;
    display: inline-flex;
    align-items: center;
    gap: 0.1rem;
    pointer-events: none;
  }
  @media (max-width: 600px) {
    .cheese-flashcard { width: 80vw; max-width: 320px; height: 200px; }
    .cheese-flashcard-main { font-size: 2rem; }
    .cheese-flashcard-hint { font-size: 1.2rem; right: 0.7rem; bottom: 0.45rem; }
    .cheese-flashcard { -webkit-tap-highlight-color: transparent; outline: none; }
  }
</style>

<script>
(function () {
  const cheeseCards = ${data};

  const root = document.getElementById("${id}");
  if (!root) return;

  cheeseCards.forEach((item, index) => {
    const card = document.createElement("button");
    card.type = "button";
    card.className = "cheese-flashcard";
    card.setAttribute("aria-label", "ì¹´ë“œ " + (index + 1));

    card.innerHTML = \`
      <div class="cheese-flashcard-inner">
        <div class="cheese-flashcard-face cheese-flashcard-front">
          <span class="cheese-flashcard-main">\${item.front}</span>
          <span class="cheese-flashcard-hint">ğŸ‘‰ ë’¤ì§‘ê¸°</span>
        </div>
        <div class="cheese-flashcard-face cheese-flashcard-back">
          <span class="cheese-flashcard-main">\${item.back}</span>
          <span class="cheese-flashcard-hint">ğŸ‘‰ ë’¤ì§‘ê¸°</span>
        </div>
      </div>
    \`;

    card.addEventListener("click", () => {
      card.classList.toggle("is-flipped");
    });

    root.appendChild(card);
  });
})();
<\/script>`;
    }

    function buildOrderSnippet_({ title, sub, labels, orderNums }){
      const id = 'cheese-order-quiz-' + uid_();

      // ìë™ id: i1, i2 ...
      const items = labels.map((label, idx)=>({ id: 'i' + (idx+1), label }));
      const correctOrder = orderNums.map(n => 'i' + n);

      const itemsJson = JSON.stringify(items);
      const correctJson = JSON.stringify(correctOrder);

      const safeTitle = title ? String(title) : 'ì‹œëŒ€ ìˆœì„œë¥¼ ë§ì¶° ë³´ì„¸ìš”';
      const safeSub = sub ? String(sub) : 'ì¹´ë“œë¥¼ ì•„ë˜ ìˆœì„œ ì˜ì—­ìœ¼ë¡œ ë“œë˜ê·¸í•´ì„œ ì˜®ê²¨ ë³´ì„¸ìš”.';

      // CSS ë³€ìˆ˜ ì—†ìœ¼ë©´ ê¹¨ì§€ëŠ” ë¶€ë¶„ì´ ìˆì–´ì„œ ê¸°ë³¸ê°’ í¬í•¨
      return `<!-- â–¼ ìˆœì„œ ë§ì¶”ê¸° í€´ì¦ˆê°€ ë“¤ì–´ê°ˆ ìë¦¬ -->
<div id="${id}" class="cheese-order-quiz"></div>

<style>
  :root{
    --coq-wine:#7B2C39;
    --coq-gray:#d1d5db;
  }
  .cheese-order-quiz {
    max-width: 720px;
    margin: 2rem auto;
    padding: 1.5rem 1.25rem;
    border-radius: 16px;
    background: #f9fafb;
    box-shadow: 0 8px 22px rgba(15, 23, 42, 0.10);
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    box-sizing: border-box;
  }
  .cheese-order-title { font-size: 2rem; font-weight: 700; margin-bottom: 1.2rem; }
  .cheese-order-sub { font-size: 1.2rem; color: #6b7280; margin-bottom: 1.2rem; }
  .cheese-order-section-label { font-size: 1.2rem; font-weight: 600; color: #4b5563; margin-bottom: 0.4rem; }
  .cheese-order-top, .cheese-order-bottom { display:flex; flex-wrap:wrap; gap:.8rem; margin-bottom:1rem; min-height:3.5rem; }
  .cheese-order-bottom{ flex-direction:column; flex-wrap:nowrap; gap:.6rem; }
  .cheese-order-card{
    flex:1 1 auto; width:100%; min-width:0; box-sizing:border-box;
    padding:.6rem 1.1rem; border-radius:999px; border:2px solid var(--coq-wine);
    background:#111827; color:#f9fafb; font-size:1.0rem; font-weight:600; text-align:center;
    cursor:grab; user-select:none; box-shadow:0 3px 8px rgba(15,23,42,.25);
    transition:transform .14s ease, box-shadow .14s ease, background .14s ease, color .14s ease, border-color .14s ease;
  }
  .cheese-order-card:active{ cursor:grabbing; }
  .cheese-order-card.is-dragging{ transform:scale(1.04); box-shadow:0 10px 22px rgba(15,23,42,.25); }
  .cheese-order-slot, .cheese-order-top-slot{
    min-width:130px; min-height:46px; border-radius:999px; border:2px dashed var(--coq-gray);
    background:#fff; display:flex; align-items:center; justify-content:center; font-size:1.2rem; color:#9ca3af;
    box-sizing:border-box;
    transition:border-color .12s ease, background .12s ease, transform .1s ease;
  }
  .cheese-order-top-slot{ flex:1 1 calc(50% - .85rem); min-width:calc(50% - .85rem); }
  .cheese-order-slot{ flex:1 1 100%; min-width:100%; }
  .cheese-order-slot.has-card{ border-style:solid; border-color:#cbd5f5; background:#eef2ff; color:transparent; }
  .cheese-order-slot.is-over{ border-color:#6366f1; background:#e0e7ff; transform:translateY(-2px); }
  .cheese-order-controls{ display:flex; flex-wrap:wrap; gap:.8rem; justify-content:flex-end; align-items:center; margin-top:.9rem; }
  .cheese-order-btn{
    padding:.7rem 1.5rem; border-radius:999px; border:none; font-size:1.2rem; font-weight:600; cursor:pointer;
    display:inline-flex; align-items:center; gap:.4rem; white-space:nowrap;
    box-shadow:0 4px 10px rgba(15,23,42,.18);
    transition:transform .12s ease, box-shadow .12s ease, opacity .12s ease;
  }
  .cheese-order-btn:not(.secondary){ background:#dc2626; color:#fff; }
  .cheese-order-btn.secondary{ background:#e5e7eb; color:#111827; }
  .cheese-order-result{ flex:1; font-size:1.5rem; color:#4b5563; }
  .cheese-order-result.ok{ color:#15803d; font-weight:600; }
  .cheese-order-result.bad{ color:#b91c1c; font-weight:600; }
  .cheese-order-guide{ display:flex; flex-direction:column; align-items:center; gap:.2rem; margin:.4rem 0 .7rem; font-size:1.2rem; color:#6b7280; }
  .cheese-order-guide-arrow{ font-size:2rem; line-height:1.5rem; }
  .cheese-order-slot-arrow{ text-align:center; font-size:1.2rem; line-height:1; color:#d1d5db; margin:.1rem 0; }
</style>

<script>
/**
 * blog-tools.js (inline)
 * ìš”êµ¬ì‚¬í•­:
 * - í”Œë˜ì‹œì¹´ë“œ / ìˆœì„œí€´ì¦ˆ íƒ­
 * - ì¸í’‹ í–‰ ì¶”ê°€/ì‚­ì œ
 * - ìƒì„± / ë³µì‚¬ / ì´ˆê¸°í™”
 * - êµ¬ë¶„ì ì…ë ¥ X (í–‰ ì¶”ê°€ ë°©ì‹)
 * - êµ¬í˜• í™˜ê²½ì—ì„œë„ ê¹¨ì§€ì§€ ì•Šê²Œ(ì˜µì…”ë„ ì²´ì´ë‹ ì œê±°)
 */

(function () {
  function $(id) { return document.getElementById(id); }

  function setMsg(id, text) {
    var el = $(id);
    if (el) el.textContent = text || '';
  }

  function escAttr_(s) {
    return String(s || '').replace(/&/g, '&amp;').replace(/"/g, '&quot;').replace(/</g, '&lt;');
  }

  function copyText_(text) {
    if (!text) return Promise.reject(new Error('ë³µì‚¬í•  ë‚´ìš©ì´ ë¹„ì–´ ìˆìŠµë‹ˆë‹¤.'));
    if (navigator.clipboard && navigator.clipboard.writeText) {
      return navigator.clipboard.writeText(text);
    }
    // fallback
    return new Promise(function (res, rej) {
      try {
        var ta = document.createElement('textarea');
        ta.value = text;
        ta.setAttribute('readonly', '');
        ta.style.position = 'fixed';
        ta.style.left = '-9999px';
        document.body.appendChild(ta);
        ta.select();
        document.execCommand('copy');
        document.body.removeChild(ta);
        res();
      } catch (e) { rej(e); }
    });
  }

  // ===== UI: íƒ­ =====
  function activateTab(which) {
    var isFlash = (which === 'flash');
    var tabFlash = $('tabFlash');
    var tabOrder = $('tabOrder');
    var secFlash = $('secFlash');
    var secOrder = $('secOrder');

    if (tabFlash) tabFlash.classList.toggle('active', isFlash);
    if (tabOrder) tabOrder.classList.toggle('active', !isFlash);
    if (secFlash) secFlash.classList.toggle('active', isFlash);
    if (secOrder) secOrder.classList.toggle('active', !isFlash);
  }

  // ===== í”Œë˜ì‹œì¹´ë“œ: í–‰ ì¶”ê°€/ìˆ˜ì§‘ =====
  function addFlashRow_(front, back) {
    front = front || '';
    back = back || '';

    var wrap = $('fcRows');
    if (!wrap) return;

    var row = document.createElement('div');
    row.className = 'row';
    row.innerHTML =
      '<input type="text" class="fc-front" placeholder="ì•ë©´(ì§ˆë¬¸/ë‹¨ì–´)" value="' + escAttr_(front) + '">' +
      '<input type="text" class="fc-back"  placeholder="ë’·ë©´(ì •ë‹µ/ëœ»)" value="' + escAttr_(back) + '">' +
      '<button type="button" class="mini fc-del">ì‚­ì œ</button>';

    var delBtn = row.querySelector('.fc-del');
    if (delBtn) delBtn.addEventListener('click', function () { row.remove(); });

    wrap.appendChild(row);
  }

  function collectFlashPairs_() {
    var wrap = $('fcRows');
    if (!wrap) throw new Error('fcRows ì˜ì—­ì´ ì—†ìŠµë‹ˆë‹¤. (HTMLì— id="fcRows" í™•ì¸)');

    var rows = Array.prototype.slice.call(wrap.querySelectorAll('.row'));
    var pairs = rows.map(function (r) {
      var f = r.querySelector('.fc-front');
      var b = r.querySelector('.fc-back');
      var front = (f && f.value ? f.value : '').trim();
      var back  = (b && b.value ? b.value : '').trim();
      return { front: front, back: back };
    }).filter(function (x) { return x.front || x.back; });

    if (pairs.length === 0) throw new Error('í”Œë˜ì‹œ ì¹´ë“œê°€ ë¹„ì–´ ìˆìŠµë‹ˆë‹¤. ì¹´ë“œ ì¶”ê°€ í›„ ì…ë ¥í•´ ì£¼ì„¸ìš”.');
    return pairs;
  }

  // ===== ìˆœì„œí€´ì¦ˆ: í–‰ ì¶”ê°€/ìˆ˜ì§‘ =====
  function addOrderRow_(label) {
    label = label || '';

    var wrap = $('oqRows');
    if (!wrap) return;

    var row = document.createElement('div');
    row.className = 'row';
    row.innerHTML =
      '<input type="text" class="oq-label" placeholder="í•­ëª©(ì •ë‹µ ìˆœì„œëŒ€ë¡œ ì…ë ¥)" value="' + escAttr_(label) + '">' +
      '<button type="button" class="mini oq-del">ì‚­ì œ</button>';

    var delBtn = row.querySelector('.oq-del');
    if (delBtn) delBtn.addEventListener('click', function () { row.remove(); });

    wrap.appendChild(row);
  }

  function collectOrderLabels_() {
    var wrap = $('oqRows');
    if (!wrap) throw new Error('oqRows ì˜ì—­ì´ ì—†ìŠµë‹ˆë‹¤. (HTMLì— id="oqRows" í™•ì¸)');

    var inputs = Array.prototype.slice.call(wrap.querySelectorAll('.oq-label'));
    var labels = inputs.map(function (el) {
      return (el && el.value ? el.value : '').trim();
    }).filter(function (v) { return !!v; });

    if (labels.length < 2) throw new Error('ìˆœì„œ í€´ì¦ˆ í•­ëª©ì€ ìµœì†Œ 2ê°œ ì´ìƒ ì…ë ¥í•´ ì£¼ì„¸ìš”.');
    return labels;
  }

  // ===== ìŠ¤ë‹ˆí« ìƒì„±ê¸° (ì—¬ê¸°ëŠ” ë„¤ê°€ ê¸°ì¡´ í…œí”Œë¦¿ ë¶™ì—¬ë„£ëŠ” ìë¦¬) =====
  // âš ï¸ ì•„ë˜ ë‘ í•¨ìˆ˜ëŠ” "ë°˜ë“œì‹œ" blog-tools.html ì–´ë”˜ê°€ì— ì¡´ì¬í•´ì•¼ í•¨.
  // - buildFlashcardSnippet_(pairs)
  // - buildOrderSnippet_({ title, sub, labels, orderNums })
  //
  // ë§Œì•½ ë„¤ íŒŒì¼ì— ì•„ì§ ì—†ë‹¤ë©´, ê¸°ì¡´ì— ë§Œë“¤ì–´ë‘” build... í•¨ìˆ˜ë“¤ì„ ê·¸ëŒ€ë¡œ ì•„ë˜ì— ì¶”ê°€í•˜ë©´ ë¨.

  // ===== ì´ë²¤íŠ¸ ë°”ì¸ë”© =====
  function wire_() {
    // íƒ­
    var tabFlash = $('tabFlash');
    var tabOrder = $('tabOrder');
    if (tabFlash) tabFlash.addEventListener('click', function () { activateTab('flash'); });
    if (tabOrder) tabOrder.addEventListener('click', function () { activateTab('order'); });

    // í–‰ ì¶”ê°€ ë²„íŠ¼
    var fcAdd = $('fcAdd');
    if (fcAdd) fcAdd.addEventListener('click', function () { addFlashRow_(); });

    var oqAdd = $('oqAdd');
    if (oqAdd) oqAdd.addEventListener('click', function () { addOrderRow_(); });

    // í”Œë˜ì‹œ ìƒì„±/ë³µì‚¬/ì´ˆê¸°í™”
    var btnGen = $('btnGen');
    if (btnGen) btnGen.addEventListener('click', function () {
      try {
        if (typeof buildFlashcardSnippet_ !== 'function') {
          throw new Error('buildFlashcardSnippet_ í•¨ìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤. (ìƒì„±ê¸° í•¨ìˆ˜ ëˆ„ë½)');
        }
        var pairs = collectFlashPairs_();
        var code = buildFlashcardSnippet_(pairs);
        var out = $('out');
        if (out) out.value = code;
        setMsg('msg', 'ìƒì„± ì™„ë£Œ');
      } catch (e) {
        setMsg('msg', e.message || String(e));
      }
    });

    var btnCopy = $('btnCopy');
    if (btnCopy) btnCopy.addEventListener('click', function () {
      copyText_(($('out') && $('out').value) ? $('out').value : '')
        .then(function () { setMsg('msg', 'ë³µì‚¬ ì™„ë£Œ'); })
        .catch(function (e) { setMsg('msg', e.message || String(e)); });
    });

    var btnClear = $('btnClear');
    if (btnClear) btnClear.addEventListener('click', function () {
      var out = $('out');
      if (out) out.value = '';
      setMsg('msg', '');
    });

    // ìˆœì„œí€´ì¦ˆ ìƒì„±/ë³µì‚¬/ì´ˆê¸°í™”
    var btnGen2 = $('btnGen2');
    if (btnGen2) btnGen2.addEventListener('click', function () {
      try {
        if (typeof buildOrderSnippet_ !== 'function') {
          throw new Error('buildOrderSnippet_ í•¨ìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤. (ìƒì„±ê¸° í•¨ìˆ˜ ëˆ„ë½)');
        }
        var labels = collectOrderLabels_();
        var title = ($('oqTitle') && $('oqTitle').value ? $('oqTitle').value : '').trim();
        var sub   = ($('oqSub') && $('oqSub').value ? $('oqSub').value : '').trim();

        // ì…ë ¥í•œ ìˆœì„œ = ì •ë‹µ ìˆœì„œ
        var orderNums = labels.map(function (_, i) { return i + 1; });

        var code = buildOrderSnippet_({ title: title, sub: sub, labels: labels, orderNums: orderNums });
        var out2 = $('out2');
        if (out2) out2.value = code;
        setMsg('msg2', 'ìƒì„± ì™„ë£Œ');
      } catch (e) {
        setMsg('msg2', e.message || String(e));
      }
    });

    var btnCopy2 = $('btnCopy2');
    if (btnCopy2) btnCopy2.addEventListener('click', function () {
      copyText_(($('out2') && $('out2').value) ? $('out2').value : '')
        .then(function () { setMsg('msg2', 'ë³µì‚¬ ì™„ë£Œ'); })
        .catch(function (e) { setMsg('msg2', e.message || String(e)); });
    });

    var btnClear2 = $('btnClear2');
    if (btnClear2) btnClear2.addEventListener('click', function () {
      var out2 = $('out2');
      if (out2) out2.value = '';
      setMsg('msg2', '');
    });
  }

  // ===== ì‹œì‘ =====
  document.addEventListener('DOMContentLoaded', function () {
    wire_();

    // ì²˜ìŒì— í•œ ì¤„ì”© ë³´ì—¬ì£¼ê¸°(ì›í•˜ë©´ ì‚­ì œ ê°€ëŠ¥)
    addFlashRow_();
    addOrderRow_();

    // ì´ˆê¸° íƒ­
    activateTab('flash');
  });

})();
</script>
</body>
</html>
