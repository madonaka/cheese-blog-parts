<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Cheese Lab Project</title>
  
  <link rel="stylesheet" href="./admin.css">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.js"></script>

  <script>
    window.CHEESE_ADMIN_API_BASE = "https://script.google.com/macros/s/AKfycbwn1TrLeSIAe570LRWMJxRzx88u3LQYF38Kme9WhMd-YQsrMsSggrNy3I_2SGKGXTpS/exec";
  </script>
  <script src="./admin-common.js" defer></script>

<style>
    /* ... ê¸°ì¡´ CSS ë³€ìˆ˜ ... */
    :root { --bg-soft: #f8fafc; --border-color: #e2e8f0; --text-main: #1e293b; --text-sub: #64748b; --primary: #3b82f6; }
    
    .dashboard-layout { display: block; max-width: 1200px; margin: 0 auto; }
    .dashboard-layout > div { min-width: 0; }

    /* ëª¨ë°”ì¼ ëŒ€ì‘ */
    @media (max-width: 1000px) { 
      .admin-main { 
        padding: 12px; 
        padding-top: calc(var(--admin-header-h, 64px) + 20px) !important; 
      } 
    }

    /* íƒ­ ë©”ë‰´ */
    .view-tabs { 
      display: flex; gap: 6px; margin-bottom: 20px; 
      background: #f1f5f9; padding: 4px; border-radius: 12px; 
      width: 100%; max-width: 100%; overflow-x: auto; white-space: nowrap; 
      -webkit-overflow-scrolling: touch; scrollbar-width: none; 
    }
    .view-tabs::-webkit-scrollbar { display: none; }

    .view-tab-btn { 
      padding: 8px 16px; border-radius: 8px; font-weight: 600; font-size: 0.9rem; 
      border: none; background: transparent; color: var(--text-sub); 
      cursor: pointer; transition: all 0.2s; white-space: nowrap; 
      flex-shrink: 0; 
    }
    .view-tab-btn:hover { color: var(--text-main); }
    .view-tab-btn.active { background: #fff; color: var(--primary); box-shadow: 0 1px 3px rgba(0,0,0,0.1); }

    /* Goal Card */
    .goal-card { background: #fff; border-radius: 16px; margin-bottom: 24px; overflow: hidden; box-shadow: 0 4px 20px -5px rgba(0,0,0,0.05); border: 1px solid var(--border-color); transition: transform 0.2s; position: relative; }
    .goal-card-header { padding: 18px 24px; color: white; display: flex; justify-content: space-between; align-items: flex-start; cursor: pointer; }
    .goal-card-header:hover { opacity: 0.95; }
    .goal-card-title { font-size: 1.25rem; font-weight: 800; line-height: 1.3; max-width: 85%; display: flex; align-items: center; gap: 8px; }
    .goal-card-desc { font-size: 0.9rem; opacity: 0.95; margin-top: 6px; font-weight: 400; line-height: 1.4; }
    .goal-date-badge { display: inline-block; background: rgba(0,0,0,0.2); border-radius: 4px; padding: 2px 8px; font-size: 0.75rem; margin-top: 6px; font-weight: 500; }
    .header-actions .action-btn { background: rgba(255,255,255,0.25); border: none; color: white; border-radius: 6px; padding: 6px 10px; cursor: pointer; margin-left: 4px; }

    /* Mid/Task */
    .mid-goal-group { padding: 20px; border-top: 1px solid #f1f5f9; }
    .mid-goal-item { margin-top: 16px; background: #fff; border-radius: 12px; border: 1px solid var(--border-color); overflow: hidden; }
    .mid-goal-item:first-child { margin-top: 0; }
    .mid-goal-header { padding: 12px 16px; display: flex; justify-content: space-between; align-items: center; background: #f8fafc; cursor: pointer; font-weight: 600; color: var(--text-main); }
    .task-list { border-top: 1px solid var(--border-color); }
    .task-row { display: flex; align-items: center; gap: 12px; padding: 12px 16px; border-bottom: 1px solid var(--border-color); cursor: pointer; transition: background 0.1s; }
    .task-row:hover { background: #fdfdfd; }
    .row-actions { display: flex; gap: 8px; opacity: 0; transition: opacity 0.2s; }
    .mid-goal-header:hover .row-actions, .task-row:hover .row-actions { opacity: 1; }
    @media(max-width:600px){ .row-actions { opacity: 1; } }
    .row-btn { background: transparent; border: none; cursor: pointer; font-size: 1.1rem; padding: 4px; color: #94a3b8; }
    .row-btn:hover { color: var(--primary); } .row-btn.delete:hover { color: #ef4444; }

    /* ğŸš€ [NEW] ë³´ë“œ ë·° (Planner ìŠ¤íƒ€ì¼) */
    .board-wrapper { display: flex; gap: 16px; overflow-x: auto; padding-bottom: 20px; height: calc(100vh - 220px); }
    .board-column { flex: 1; min-width: 280px; max-width: 400px; background: #f1f5f9; border-radius: 12px; display: flex; flex-direction: column; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); }
    
    .column-header { padding: 14px; font-weight: 800; font-size: 1rem; border-radius: 12px 12px 0 0; color: white; text-align: center; }
    .header-high { background: linear-gradient(135deg, #ef4444, #dc2626); }
    .header-normal { background: linear-gradient(135deg, #3b82f6, #2563eb); }
    .header-low { background: linear-gradient(135deg, #10b981, #059669); }

    .column-content { flex: 1; overflow-y: auto; padding: 12px; display: flex; flex-direction: column; gap: 10px; }
    .column-done-content { padding: 12px; display: flex; flex-direction: column; gap: 10px; background: #e2e8f0; border-radius: 0 0 12px 12px; border-top: 1px solid #cbd5e1; }

    .board-card { background: #fff; border-radius: 8px; padding: 12px 14px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border: 1px solid #e2e8f0; cursor: pointer; transition: transform 0.2s; position: relative; }
    .board-card:hover { transform: translateY(-2px); box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
    .board-card.done { opacity: 0.7; background: #f8fafc; color: #94a3b8; }
    .board-card.done .board-card-title { text-decoration: line-through; }

    .board-card-title { font-weight: 700; margin-bottom: 6px; font-size: 0.95rem; color: #1e293b; line-height: 1.4; }
    .board-card-meta { display: flex; justify-content: space-between; align-items: center; font-size: 0.75rem; color: #64748b; }
    .board-date-badge { background: #eff6ff; color: #3b82f6; padding: 2px 6px; border-radius: 4px; font-weight: 600; }
    .board-overdue { background: #fef2f2; color: #ef4444; }

    .completed-toggle-btn { width: 100%; border: none; background: #cbd5e1; color: #475569; padding: 10px; font-weight: 700; cursor: pointer; text-align: center; transition: background 0.2s; font-size: 0.85rem; }
    .completed-toggle-btn:hover { background: #94a3b8; color: #fff; }
    
    /* ë²„ê·¸ íŠ¸ë˜ì»¤ ìŠ¤íƒ€ì¼ */
    .bug-container { border-top: 4px solid #ef4444; }
    .bug-card { background: #fff; border: 1px solid #e2e8f0; border-radius: 16px; padding: 20px; transition: all 0.2s; position: relative; box-shadow: 0 2px 8px rgba(0,0,0,0.04); display: flex; flex-direction: column; height: 100%; border-top: 5px solid #ef4444; }
    .bug-card:hover { transform: translateY(-3px); box-shadow: 0 10px 20px -5px rgba(239, 68, 68, 0.15); }
    .bug-card.working { border: 2px solid #f87171; background: #fef2f2; }
    .bug-status-badge { position: absolute; top: -10px; right: 12px; background: #ef4444; color: white; font-size: 0.75rem; padding: 4px 10px; border-radius: 20px; font-weight: 800; box-shadow: 0 4px 6px -1px rgba(239, 68, 68, 0.4); z-index: 2; }
    .bug-parent-info { font-size: 0.75rem; color: #94a3b8; margin-bottom: 4px; display:flex; align-items:center; gap:4px; }
    .bug-title { font-weight: 800; font-size: 1.05rem; margin-bottom: 8px; color: #7f1d1d; line-height: 1.3; }
    .bug-body { font-size: 0.9rem; color: #7f1d1d; opacity:0.8; line-height: 1.5; flex-grow: 1; margin-bottom: 16px; overflow: hidden; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; }
    .bug-footer { display: flex; gap: 8px; margin-top: auto; border-top: 1px solid #fee2e2; padding-top: 12px; }
    .bug-btn { flex: 1; border: none; padding: 8px; border-radius: 8px; cursor: pointer; font-size: 0.85rem; font-weight: 600; transition: 0.2s; }
    .bug-btn.check { background: #fff1f2; color: #e11d48; } .bug-btn.check:hover { background: #ffe4e6; }
    .bug-btn.solve { background: #f0fdf4; color: #16a34a; } .bug-btn.solve:hover { background: #dcfce7; }
    .bug-btn.restore { background: #f1f5f9; color: #64748b; } .bug-btn.restore:hover { background: #e2e8f0; }

    /* Idea */
    .idea-container { padding: 0 4px; }
    .idea-toolbar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
    .idea-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: 16px; }
    .idea-card { background: #fff; border: 1px solid var(--border-color); border-radius: 16px; padding: 20px; transition: all 0.2s; position: relative; box-shadow: 0 2px 8px rgba(0,0,0,0.04); display: flex; flex-direction: column; height: 100%; border-top: 5px solid #d8b4fe; }
    .idea-card:hover { transform: translateY(-3px); box-shadow: 0 10px 20px -5px rgba(0,0,0,0.1); }
    .idea-card.realized { border: 2px solid #60a5fa; background: #f8fbff; }
    .realized-badge { position: absolute; top: -10px; right: 12px; background: #3b82f6; color: white; font-size: 0.75rem; padding: 4px 10px; border-radius: 20px; font-weight: 800; box-shadow: 0 4px 6px -1px rgba(59, 130, 246, 0.4); z-index: 2; }
    .idea-header { display: flex; justify-content: flex-start; margin-bottom: 8px; }
    .idea-date { font-size: 0.75rem; color: #64748b; background: #f1f5f9; padding: 4px 8px; border-radius: 6px; font-weight: 600; display: inline-flex; align-items: center; gap: 4px; }
    .idea-title { font-weight: 800; font-size: 1.1rem; margin-bottom: 8px; color: #1e293b; line-height: 1.3; }
    .idea-body { font-size: 0.9rem; color: #64748b; line-height: 1.5; flex-grow: 1; margin-bottom: 16px; overflow: hidden; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; }
    .idea-footer { display: flex; gap: 8px; margin-top: auto; border-top: 1px solid #f1f5f9; padding-top: 12px; }
    .idea-btn { flex: 1; border: none; background: #f1f5f9; color: #64748b; padding: 8px; border-radius: 8px; cursor: pointer; font-size: 0.85rem; font-weight: 600; transition: 0.2s; }
    .idea-btn:hover { background: #e2e8f0; color: #334155; }
    .idea-btn.plan { background: #eff6ff; color: #3b82f6; } .idea-btn.plan:hover { background: #dbeafe; }
    .idea-btn.done { background: #f0fdf4; color: #16a34a; } .idea-btn.done:hover { background: #dcfce7; }

    /* Log */
    .log-container { background: #fff; border-radius: 16px; padding: 32px; border: 1px solid var(--border-color); min-height: 600px; }
    .log-item { position: relative; padding-left: 24px; margin-bottom: 28px; max-width: 800px; }
    .log-item::before { content: ''; position: absolute; left: 7px; top: 24px; bottom: -30px; width: 2px; background: #e2e8f0; }
    .log-item:last-child::before { display: block; background: linear-gradient(to bottom, #e2e8f0 50%, transparent 100%); }
    .log-dot { position: absolute; left: 0; top: 6px; width: 16px; height: 16px; background: #fff; border: 4px solid var(--primary); border-radius: 50%; }
    .log-card { background: #fff; border: 1px solid #e2e8f0; border-radius: 12px; padding: 16px; transition: box-shadow 0.2s; position: relative; box-shadow: 0 1px 3px rgba(0,0,0,0.03); }
    .log-header { display: flex; justify-content: space-between; margin-bottom: 8px; align-items: center; }
    .log-time { font-size: 0.75rem; color: #94a3b8; font-weight: 600; display:flex; align-items:center; gap:4px; }
    .log-related { display: inline-block; font-size: 0.75rem; color: #059669; background: #ecfdf5; padding: 2px 8px; border-radius: 4px; font-weight: 600; margin-bottom: 6px; }
    .log-actions { position: absolute; top: 12px; right: 12px; display: flex; gap: 8px; opacity: 0; transition: opacity 0.2s; }
    .log-card:hover .log-actions { opacity: 1; }
    .log-count-badge { font-size: 0.75rem; color: #64748b; background: #f1f5f9; padding: 2px 6px; border-radius: 4px; margin-left: 6px; display: inline-flex; align-items: center; gap: 3px; }
    .log-date-divider { display: flex; align-items: center; margin: 30px 0 15px; font-weight: 700; color: #475569; font-size: 0.9rem; }
    .log-date-divider::before, .log-date-divider::after { content: ''; flex: 1; height: 1px; background: #e2e8f0; }
    .log-date-divider::before { margin-right: 12px; } .log-date-divider::after { margin-left: 12px; }
    @media (max-width: 600px) { .log-container { padding: 16px; } .log-actions { opacity: 1; position: relative; top:0; right:0; margin-left: auto; } .log-header { flex-wrap: wrap; gap: 8px; } }

    /* Utils */
    .color-options { display: flex; gap: 10px; margin-top: 8px; flex-wrap: wrap; }
    .color-radio { display: none; }
    .color-label { width: 32px; height: 32px; border-radius: 50%; cursor: pointer; border: 2px solid transparent; transition: transform 0.2s; }
    .color-radio:checked + .color-label { transform: scale(1.1); box-shadow: 0 0 0 2px #fff, 0 0 0 4px #94a3b8; }
    .check-circle { width: 22px; height: 22px; border: 2px solid #cbd5e1; border-radius: 50%; cursor: pointer; position: relative; flex-shrink: 0; }
    .check-circle.checked { background: #10b981; border-color: #10b981; }
    .check-circle.checked::after { content: 'âœ”'; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: white; font-size: 12px; }
    .fab-menu { position: fixed; bottom: 30px; right: 30px; display: flex; flex-direction: column; gap: 12px; align-items: flex-end; z-index: 1000; }
    .fab-btn { width: 56px; height: 56px; border-radius: 50%; border: none; color: white; font-size: 24px; box-shadow: 0 10px 25px rgba(37, 99, 235, 0.3); cursor: pointer; display: flex; align-items: center; justify-content: center; transition: transform 0.2s; }
    .fab-main { background: var(--primary); }
    .fab-sub { width: 48px; height: 48px; background: #475569; font-size: 20px; display: none; }
    .fab-menu:hover .fab-sub { display: flex; }

    /* ëª¨ë‹¬ */
    .custom-modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 2000; align-items: center; justify-content: center; backdrop-filter: blur(4px); }
    .custom-modal.open { display: flex; }
    .modal-box { background: #fff; padding: 32px; border-radius: 20px; width: 90%; max-width: 800px; max-height: 90vh; overflow-y: auto; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); }
    @media (max-width: 600px) { .date-group { flex-direction: column !important; gap: 10px !important; } .modal-box { width: 95% !important; padding: 20px !important; max-width: 100%; border-radius: 16px; } }
    .view-content-box { padding: 16px; background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; min-height: 100px; line-height: 1.6; color: #334155; margin-top: 4px; }
    .view-content-box img { max-width: 100%; height: auto; border-radius: 4px; }
    
    .modal-section { margin-top: 24px; padding-top: 16px; border-top: 1px solid #e2e8f0; }
    .section-title { font-size: 0.95rem; font-weight: 700; color: #475569; margin-bottom: 12px; display:flex; align-items:center; gap:6px; }
    
    /* íˆìŠ¤í† ë¦¬ ìŠ¤íƒ€ì¼ (ì ‘ê¸°/í¼ì¹˜ê¸°) */
    .history-list { display: flex; flex-direction: column; gap: 10px; }
    .history-item { background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 12px; font-size: 0.9rem; position: relative; cursor: pointer; transition: background 0.2s; }
    .history-item:hover { background: #f1f5f9; }
    .history-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px; }
    .history-date { font-weight: 700; color: #64748b; font-size: 0.75rem; background: #fff; padding: 2px 8px; border-radius: 12px; border: 1px solid #e2e8f0; }
    .history-time { font-size: 0.75rem; color: #94a3b8; font-weight: 600; }
    .history-content { color: #334155; line-height: 1.5; font-size: 0.9rem; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; text-overflow: ellipsis; white-space: normal; }
    .history-item.expanded .history-content { display: block; -webkit-line-clamp: unset; overflow: visible; }
    .history-item::after { content: 'â–¼ ë”ë³´ê¸°'; display: block; text-align: center; font-size: 0.7rem; color: #cbd5e1; margin-top: 6px; }
    .history-item.expanded::after { content: 'â–² ì ‘ê¸°'; }

    /* ê´€ë ¨ ì•„ì´ë””ì–´(ë¯¸ë‹ˆ ì¹´ë“œ) */
    .mini-idea-grid { display: flex; gap: 12px; overflow-x: auto; padding-bottom: 8px; }
    .mini-idea-card { min-width: 200px; max-width: 200px; background: #fff; border: 1px solid #e2e8f0; border-radius: 12px; padding: 12px; border-top: 4px solid #d8b4fe; cursor: pointer; flex-shrink: 0; }
    .mini-idea-card:hover { transform: translateY(-2px); box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); }
    .mini-idea-title { font-weight: 700; font-size: 0.9rem; margin-bottom: 4px; color: #333; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; }
    .mini-idea-desc { font-size: 0.8rem; color: #64748b; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; line-height: 1.4; }
    
    #log-bug-section { background: #fef2f2; padding: 12px; border-radius: 8px; border: 1px dashed #ef4444; margin-top: 10px; }
    #log-bug-section label { color: #b91c1c; font-weight: 700; display:flex; align-items:center; gap:4px; }
    #log-bug-section input { border-color: #fca5a5; }
    
    /* ì¤‘ê°„ ëª©í‘œ ë‚´ ì•„ì´ë””ì–´ ìŠ¬ë¼ì´ë” */
    .mid-idea-slider { display: flex; gap: 10px; overflow-x: auto; padding: 12px 16px; background: #f1f5f9; border-bottom: 1px solid #e2e8f0; scrollbar-width: thin; }
    .mid-idea-slider::-webkit-scrollbar { height: 6px; }
    .mid-idea-slider::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
    .mid-idea-card-mini { min-width: 180px; max-width: 180px; background: #fff; border: 1px solid #cbd5e1; border-radius: 8px; padding: 10px; cursor: pointer; flex-shrink: 0; border-top: 3px solid #d8b4fe; transition: transform 0.1s; display: flex; flex-direction: column; }
    .mid-idea-card-mini:hover { transform: translateY(-2px); box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); }
    .mic-date { font-size: 0.7rem; color: #94a3b8; margin-bottom: 4px; }
    .mic-title { font-size: 0.85rem; font-weight: 700; color: #333; margin-bottom: 4px; line-height: 1.3; }
    .mic-desc { font-size: 0.75rem; color: #64748b; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; }
  
    /* [ìˆ˜ì •] ì•„ì´ë””ì–´ íƒ­ & ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
    .idea-nav {
      display: flex;
      gap: 8px;
      margin-bottom: 20px;
      border-bottom: 1px solid #e2e8f0;
      padding-bottom: 12px;
      overflow-x: auto;
      white-space: nowrap;
    }
    
    .idea-tab-btn {
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 0.9rem;
      font-weight: 600;
      color: #64748b;
      background: #fff;
      border: 1px solid #e2e8f0;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .idea-tab-btn:hover { background: #f8fafc; color: #334155; }
    .idea-tab-btn.active {
      background: #3b82f6; 
      color: #fff; 
      border-color: #3b82f6; 
      box-shadow: 0 4px 6px -1px rgba(59, 130, 246, 0.3);
    }
    
    /* íƒ­ë³„ í¬ì¸íŠ¸ ì»¬ëŸ¬ (Active ìƒíƒœì¼ ë•Œ) */
    .idea-tab-btn[data-cat="blog"].active { background: #db2777; border-color: #db2777; box-shadow: 0 4px 6px -1px rgba(219, 39, 119, 0.3); }
    .idea-tab-btn[data-cat="system"].active { background: #2563eb; border-color: #2563eb; box-shadow: 0 4px 6px -1px rgba(37, 99, 235, 0.3); }
    .idea-tab-btn[data-cat="biz"].active { background: #d97706; border-color: #d97706; box-shadow: 0 4px 6px -1px rgba(217, 119, 6, 0.3); }
    .idea-tab-btn[data-cat="etc"].active { background: #64748b; border-color: #64748b; box-shadow: 0 4px 6px -1px rgba(100, 116, 139, 0.3); }
    .idea-tab-btn[data-cat="realized"].active { background: #10b981; border-color: #10b981; box-shadow: 0 4px 6px -1px rgba(16, 185, 129, 0.3); }
    
    /* ì•„ì´ë””ì–´ ê·¸ë¦¬ë“œ (ë°˜ì‘í˜• ì¹´ë“œ ë°°ì¹˜) */
    .idea-list-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 16px;
      min-height: 400px;
    }
    
    .idea-card-item {
      background: #fff;
      border: 1px solid #e2e8f0;
      border-radius: 12px;
      padding: 16px;
      position: relative;
      transition: transform 0.2s, box-shadow 0.2s;
      display: flex;
      flex-direction: column;
      border-top: 4px solid #cbd5e1; /* ê¸°ë³¸ìƒ‰ */
    }
    .idea-card-item:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 15px -3px rgba(0,0,0,0.08);
    }
    
    /* ì¹´í…Œê³ ë¦¬ë³„ ì¹´ë“œ íƒ‘ ë³´ë” ìƒ‰ìƒ */
    .idea-card-item.cat-blog { border-top-color: #db2777; }
    .idea-card-item.cat-system { border-top-color: #2563eb; }
    .idea-card-item.cat-biz { border-top-color: #d97706; }
    .idea-card-item.cat-etc { border-top-color: #64748b; }
    .idea-card-item.is-realized { background: #f0fdf4; border: 1px solid #bbf7d0; border-top-color: #10b981; }
    
    .ici-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
    .ici-date { font-size: 0.75rem; color: #94a3b8; font-weight: 500; display: flex; align-items: center; gap: 4px; }
    .ici-badge { font-size: 0.7rem; padding: 2px 6px; border-radius: 4px; font-weight: 700; color: #fff; }
    .ici-title { font-size: 1.05rem; font-weight: 700; color: #1e293b; margin-bottom: 8px; line-height: 1.3; }
    .ici-body { font-size: 0.9rem; color: #64748b; line-height: 1.5; flex: 1; margin-bottom: 12px; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }
    .ici-footer { display: flex; justify-content: space-between; align-items: center; padding-top: 10px; border-top: 1px dashed #e2e8f0; margin-top: auto; }

    /* [ì¶”ê°€] ë²„íŠ¼ ë¡œë”© ìŠ¤í”¼ë„ˆ ìŠ¤íƒ€ì¼ */
    .btn-spinner {
      display: inline-block;
      width: 14px;
      height: 14px;
      border: 2px solid rgba(255,255,255,0.4);
      border-radius: 50%;
      border-top-color: #fff;
      animation: spin 0.8s linear infinite;
      margin-right: 6px;
      vertical-align: middle;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
    
    /* ë¡œë”© ì¤‘ì¼ ë•Œ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    .btn.loading {
      position: relative;
      pointer-events: none; /* í´ë¦­ ë°©ì§€ */
      opacity: 0.7;
    }  
  /* [NEW] ëª¨ë‹¬ ë””ìì¸ ê°œì„  (Modern UI) */
.modal-box {
  background: #fff;
  border-radius: 24px;
  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
  width: 700px; /* ë„ˆë¹„ë¥¼ ì¢€ ë” ë„“í˜€ ì‹œì›í•˜ê²Œ */
  max-width: 95vw;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  max-height: 90vh; /* í™”ë©´ ê½‰ ì°¨ì§€ ì•Šê²Œ */
}

/* í—¤ë” */
.modal-header-custom {
  padding: 24px 32px;
  background: #fff;
  border-bottom: 1px solid #f1f5f9;
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.modal-title-custom {
  font-size: 1.5rem;
  font-weight: 800;
  color: #1e293b;
}

/* ë°”ë”” (ìŠ¤í¬ë¡¤ ì˜ì—­) */
.modal-body-custom {
  padding: 32px;
  background: #f8fafc;
  overflow-y: auto;
  flex: 1;
}

/* í¼ ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ */
.form-grid {
  display: grid;
  gap: 24px;
}
.form-row {
  display: grid;
  grid-template-columns: 1fr 1fr; /* 2ì—´ ë°°ì¹˜ */
  gap: 20px;
}

/* ë¼ë²¨ ìŠ¤íƒ€ì¼ */
.input-label {
  display: block;
  margin-bottom: 8px;
  font-size: 0.9rem;
  font-weight: 700;
  color: #475569;
}

/* ì…ë ¥ í•„ë“œ ê³µí†µ */
.styled-input {
  width: 100%;
  padding: 12px 16px;
  border: 1px solid #e2e8f0;
  border-radius: 12px;
  background: #fff;
  font-size: 1rem;
  color: #334155;
  transition: all 0.2s;
}
.styled-input:focus {
  outline: none;
  border-color: #3b82f6;
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

/* ìœ í˜• ì„ íƒ (íƒ­ ìŠ¤íƒ€ì¼) */
.type-selector-wrapper {
  background: #e2e8f0;
  padding: 4px;
  border-radius: 14px;
  display: flex;
  gap: 4px;
}
.type-selector-wrapper label {
  flex: 1;
  text-align: center;
  padding: 10px;
  border-radius: 10px;
  cursor: pointer;
  font-weight: 600;
  font-size: 0.9rem;
  color: #64748b;
  transition: all 0.2s;
}
.type-selector-wrapper input { display: none; } /* ë¼ë””ì˜¤ ë²„íŠ¼ ìˆ¨ê¹€ */
.type-selector-wrapper input:checked + label {
  background: #fff;
  color: #3b82f6;
  box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}
/* ìœ í˜•ë³„ í¬ì¸íŠ¸ ì»¬ëŸ¬ */
.type-selector-wrapper input[value="ë²„ê·¸"]:checked + label { color: #ef4444; }
.type-selector-wrapper input[value="ì•„ì´ë””ì–´"]:checked + label { color: #db2777; }

/* ì•„ì´ë””ì–´/ìƒ‰ìƒ ë¶„ë¥˜ (ì¹© ìŠ¤íƒ€ì¼) */
.color-chip-wrapper { display: flex; gap: 8px; flex-wrap: wrap; }
.color-chip-option {
  display: flex; align-items: center; gap: 6px;
  padding: 8px 14px;
  border-radius: 20px;
  border: 1px solid #e2e8f0;
  background: #fff;
  cursor: pointer;
  font-weight: 600;
  color: #64748b;
  font-size: 0.9rem;
  transition: all 0.2s;
}
.color-radio { display: none; }
.color-radio:checked + .color-chip-option {
  border-color: transparent;
  color: #fff;
  box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
}
/* ì„ íƒ ì‹œ ë°°ê²½ìƒ‰ ì ìš© (ìŠ¤í¬ë¦½íŠ¸ê°€ ì—†ì–´ë„ CSSë¡œ ì²˜ë¦¬) */
.color-radio[value="#db2777"]:checked + .color-chip-option { background: #db2777; }
.color-radio[value="#2563eb"]:checked + .color-chip-option { background: #2563eb; }
.color-radio[value="#d97706"]:checked + .color-chip-option { background: #d97706; }
.color-radio[value="#64748b"]:checked + .color-chip-option { background: #64748b; }
.color-radio[value="#4f46e5"]:checked + .color-chip-option { background: #4f46e5; }
.color-radio[value="#059669"]:checked + .color-chip-option { background: #059669; }

/* í‘¸í„° (ë²„íŠ¼ ì˜ì—­) */
.modal-footer-custom {
  padding: 20px 32px;
  background: #fff;
  border-top: 1px solid #f1f5f9;
  display: flex;
  justify-content: flex-end;
  gap: 12px;
}
.btn-close-custom {
  padding: 12px 24px;
  border-radius: 12px;
  border: 1px solid #e2e8f0;
  background: #fff;
  color: #64748b;
  font-weight: 700;
  cursor: pointer;
}
.btn-save-custom {
  padding: 12px 24px;
  border-radius: 12px;
  background: #10b981; /* ì—ë©”ë„ë“œ ê·¸ë¦° */
  color: #fff;
  font-weight: 700;
  border: none;
  cursor: pointer;
  box-shadow: 0 4px 6px -1px rgba(16, 185, 129, 0.3);
}
.btn-save-custom:hover { background: #059669; }

  /* [í•„ìˆ˜] ëª¨ë‹¬ ì˜¤ë²„ë ˆì´ (ë°°ê²½) ìŠ¤íƒ€ì¼ - ì´ê²Œ ì—†ìœ¼ë©´ ë²„íŠ¼ì´ ì•ˆ ëˆŒë¦½ë‹ˆë‹¤! */
.modal-overlay {
  display: none; /* ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê¹€ */
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4); /* ë°˜íˆ¬ëª… ë°°ê²½ */
  z-index: 2000; /* FAB(1000)ë³´ë‹¤ ë†’ì€ ìš°ì„ ìˆœìœ„ */
  align-items: center;
  justify-content: center;
  backdrop-filter: blur(4px); /* ë°°ê²½ íë¦¼ íš¨ê³¼ */
}

/* ëª¨ë‹¬ì´ ì—´ë ¸ì„ ë•Œ (JSì—ì„œ .open í´ë˜ìŠ¤ ì¶”ê°€ ì‹œ ë™ì‘) */
.modal-overlay.open {
  display: flex;
}
  /* ê¸°ì¡´ .fab-menu ìŠ¤íƒ€ì¼ì„ ì°¾ì•„ì„œ z-indexë¥¼ 1000 -> 1500 ì •ë„ë¡œ ìƒí–¥ */
.fab-menu {
  /* ... ê¸°ì¡´ ìŠ¤íƒ€ì¼ ... */
  z-index: 1500; 
}
  /* [ìˆ˜ì •] ëª¨ë‹¬ ë°•ìŠ¤ ë ˆì´ì•„ì›ƒ (ìŠ¤í¬ë¡¤ ë²„ê·¸ ìˆ˜ì •) */
.modal-box {
  background: #fff;
  border-radius: 24px;
  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
  width: 700px;
  max-width: 95vw;
  
  /* í™”ë©´ ë†’ì´ì˜ 90%ê¹Œì§€ë§Œ ì°¨ì§€í•˜ë„ë¡ ì œí•œ */
  height: auto;
  max-height: 90vh; 
  
  display: flex;
  flex-direction: column;
  overflow: hidden; /* ë°•ìŠ¤ ë°–ìœ¼ë¡œ ë‚˜ê°€ëŠ” ë‚´ìš© ìˆ¨ê¹€ */
}

/* [ì¶”ê°€] í¼ íƒœê·¸ê°€ ëª¨ë‹¬ ë°•ìŠ¤ë¥¼ ê°€ë“ ì±„ìš°ê²Œ ì„¤ì • */
#todo-form {
  display: flex;
  flex-direction: column;
  height: 100%; /* ë¶€ëª¨(.modal-box) ë†’ì´ë¥¼ ê½‰ ì±„ì›€ */
  overflow: hidden;
}

/* í—¤ë”ëŠ” ê³ ì • */
.modal-header-custom {
  flex-shrink: 0; /* ì¤„ì–´ë“¤ì§€ ì•ŠìŒ */
  padding: 20px 32px; /* íŒ¨ë”© ì•½ê°„ ì¡°ì • */
  background: #fff;
  border-bottom: 1px solid #f1f5f9;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

/* [ìˆ˜ì •] ë°”ë”” (ì—¬ê¸°ê°€ ìŠ¤í¬ë¡¤ ë˜ì–´ì•¼ í•¨) */
.modal-body-custom {
  flex: 1; /* ë‚¨ì€ ê³µê°„ì„ ëª¨ë‘ ì°¨ì§€ */
  overflow-y: auto; /* ì„¸ë¡œ ìŠ¤í¬ë¡¤ í™œì„±í™” */
  padding: 32px;
  background: #f8fafc;
  min-height: 0; /* í”Œë ‰ìŠ¤ ë°•ìŠ¤ ìŠ¤í¬ë¡¤ ë²„ê·¸ ë°©ì§€ìš© í•„ìˆ˜ ì½”ë“œ */
}

/* í‘¸í„°ë„ ê³ ì • */
.modal-footer-custom {
  flex-shrink: 0; /* ì¤„ì–´ë“¤ì§€ ì•ŠìŒ */
  padding: 20px 32px;
  background: #fff;
  border-top: 1px solid #f1f5f9;
  display: flex;
  justify-content: flex-end;
  gap: 12px;
  z-index: 10;
}
  /* [ì¶”ê°€] ì»¤ìŠ¤í…€ ìŠ¤í¬ë¡¤ ë°” ë””ìì¸ (ì „ì²´ ì ìš©) */

/* 1. ìŠ¤í¬ë¡¤ ë°”ì˜ ë„ˆë¹„ ì„¤ì • */
::-webkit-scrollbar {
  width: 8px;  /* ì„¸ë¡œ ìŠ¤í¬ë¡¤ ë‘ê»˜ */
  height: 8px; /* ê°€ë¡œ ìŠ¤í¬ë¡¤ ë‘ê»˜ */
}

/* 2. ìŠ¤í¬ë¡¤ íŠ¸ë™ (ë°°ê²½) - íˆ¬ëª…í•˜ê²Œ */
::-webkit-scrollbar-track {
  background: transparent; 
}

/* 3. ìŠ¤í¬ë¡¤ ë§‰ëŒ€ (ì†ì¡ì´) ë””ìì¸ */
::-webkit-scrollbar-thumb {
  background-color: #cbd5e1; /* ë¶€ë“œëŸ¬ìš´ íšŒìƒ‰ */
  border-radius: 4px;       /* ë‘¥ê·¼ ëª¨ì„œë¦¬ */
  
  /* ë§‰ëŒ€ ì£¼ë³€ì— íˆ¬ëª… í…Œë‘ë¦¬ë¥¼ ì¤˜ì„œ ê³µì¤‘ì— ëœ¬ ëŠë‚Œ ì—°ì¶œ */
  border: 2px solid transparent;
  background-clip: content-box;
}

/* 4. ë§ˆìš°ìŠ¤ ì˜¬ë ¸ì„ ë•Œ ì§„í•˜ê²Œ */
::-webkit-scrollbar-thumb:hover {
  background-color: #94a3b8;
}
  /* [ì¶”ê°€] ì‹œìŠ¤í…œ ë²„ì „ í‘œì‹œ ìŠ¤íƒ€ì¼ */
.sys-version-large {
  font-size: 1.1rem;
  font-weight: 800;
  color: #ef4444; /* ë¶‰ì€ìƒ‰ í¬ì¸íŠ¸ */
  background: #fee2e2;
  display: inline-block;
  padding: 4px 12px;
  border-radius: 20px;
  margin-bottom: 20px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}
  </style>
</head>
<body>

<div class="admin-shell">
  <div id="admin-header-slot"></div>
  <main class="admin-main">
    <aside id="admin-menu-slot" class="admin-sidebar"></aside>

    <section class="admin-content">
      <div style="margin-bottom: 24px;">
        <h2 style="font-size: 1.8rem; font-weight: 800; color: var(--text-main); margin: 0;">Dashboard</h2>
        <p style="color: var(--text-sub); margin-top: 4px;">í”„ë¡œì íŠ¸ í˜„í™© ê´€ë¦¬</p>
        <div id="sysVersion" class="sys-version-large">Checking version...</div>
      </div>

      <div class="dashboard-layout">
        
        <div class="view-tabs">
          <button class="view-tab-btn active" onclick="switchView('card')" id="btn-view-card">ğŸ—‚ ê³„ì¸µí˜•</button>
          <button class="view-tab-btn" onclick="switchView('board')" id="btn-view-board">ğŸ“‹ ê²Œì‹œíŒ</button>
          <button class="view-tab-btn" onclick="switchView('bug')" id="btn-view-bug">ğŸ ë²„ê·¸ íŠ¸ë˜ì»¤</button> 
          <button class="view-tab-btn" onclick="switchView('idea')" id="btn-view-idea">ğŸ’¡ ì•„ì´ë””ì–´ í•¨</button>
          <button class="view-tab-btn" onclick="switchView('log')" id="btn-view-log">ğŸ“ ì‘ì—… ë¡œê·¸</button>
        </div>

        <div id="view-card-container"><div id="goal-tree-root"><div class="goal-card" style="padding:40px; text-align:center; color:#94a3b8; background:#f1f5f9;">ë°ì´í„° ë¡œë”© ì¤‘...</div></div></div>
        
        <div id="view-board-container" style="display:none;">
          <div class="board-wrapper">
            <div class="board-column">
              <div class="column-header header-high">ğŸ”¥ ë†’ìŒ (High)</div>
              <div id="board-col-high" class="column-content"></div>
              <div class="column-footer">
                 <button class="completed-toggle-btn" onclick="toggleBoardCompleted('high')">
                   âœ… ì™„ë£Œë¨ <span id="count-high-done">(0)</span> â–¼
                 </button>
                 <div id="board-col-high-done" class="column-done-content" style="display:none;"></div>
              </div>
            </div>
            <div class="board-column">
              <div class="column-header header-normal">ğŸ”µ ë³´í†µ (Normal)</div>
              <div id="board-col-normal" class="column-content"></div>
              <div class="column-footer">
                 <button class="completed-toggle-btn" onclick="toggleBoardCompleted('normal')">
                   âœ… ì™„ë£Œë¨ <span id="count-normal-done">(0)</span> â–¼
                 </button>
                 <div id="board-col-normal-done" class="column-done-content" style="display:none;"></div>
              </div>
            </div>
            <div class="board-column">
              <div class="column-header header-low">ğŸŒ± ë‚®ìŒ (Low)</div>
              <div id="board-col-low" class="column-content"></div>
              <div class="column-footer">
                 <button class="completed-toggle-btn" onclick="toggleBoardCompleted('low')">
                   âœ… ì™„ë£Œë¨ <span id="count-low-done">(0)</span> â–¼
                 </button>
                 <div id="board-col-low-done" class="column-done-content" style="display:none;"></div>
              </div>
            </div>
          </div>
        </div>
        
        <div id="view-bug-container" style="display:none;">
          <div class="idea-container">
            <div class="idea-toolbar">
              <span style="font-size:0.9rem; color:#b91c1c; font-weight:600;">ğŸš¨ ë°œê²¬ëœ ë²„ê·¸ ë° ì´ìŠˆ íŠ¸ë˜ì»¤</span>
              <label style="cursor:pointer; display:flex; align-items:center; gap:6px; font-size:0.9rem;">
                <input type="checkbox" id="toggle-bug-archive" onchange="renderBugView()">
                <span>âœ… í•´ê²°ëœ ë²„ê·¸ ë³´ê¸° (ì•„ì¹´ì´ë¸Œ)</span>
              </label>
            </div>
            <div id="bug-grid-root" class="idea-grid"></div>
          </div>
        </div>

      <div id="view-idea-container" style="display:none;">
        <div class="idea-container">
          <div class="idea-toolbar" style="margin-bottom: 10px;">
            <div style="display:flex; flex-direction:column;">
              <span style="font-size:1.1rem; color:#1e293b; font-weight:800;">ğŸ’¡ ì•„ì´ë””ì–´ ë±…í¬</span>
              <span style="font-size:0.85rem; color:#64748b;">ë²ˆëœ©ì´ëŠ” ì˜ê°ì„ ê¸°ë¡í•˜ê³  ì‹¤í˜„í•´ë³´ì„¸ìš”.</span>
            </div>
            <select id="idea-sort-select" class="sort-select" onchange="renderIdeaView()">
              <option value="newest">ğŸ“… ìµœì‹ ìˆœ</option>
              <option value="oldest">â³ ì˜¤ë˜ëœìˆœ</option>
            </select>
          </div>
      
          <div class="idea-nav">
            <button class="idea-tab-btn active" onclick="switchIdeaTab('all')" id="itab-all">ğŸ“‚ ì „ì²´</button>
            <button class="idea-tab-btn" onclick="switchIdeaTab('blog')" id="itab-blog" data-cat="blog">ğŸ“ ë¸”ë¡œê·¸</button>
            <button class="idea-tab-btn" onclick="switchIdeaTab('system')" id="itab-system" data-cat="system">âš™ï¸ ì‹œìŠ¤í…œ</button>
            <button class="idea-tab-btn" onclick="switchIdeaTab('biz')" id="itab-biz" data-cat="biz">ğŸ§€ ì‚¬ì—…/êµ¬ìƒ</button>
            <button class="idea-tab-btn" onclick="switchIdeaTab('etc')" id="itab-etc" data-cat="etc">ğŸ’­ ì¡ë‹´/ìƒê°</button>
            <div style="width:1px; background:#e2e8f0; margin:0 4px;"></div>
            <button class="idea-tab-btn" onclick="switchIdeaTab('realized')" id="itab-realized" data-cat="realized">ğŸš€ ì‹¤í˜„ë¨</button>
          </div>
      
          <div id="idea-list-root" class="idea-list-grid"></div>
        </div>
      </div>



        
        <div id="view-log-container" style="display:none;">
          <div class="log-container">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
              <h3 style="margin: 0; font-size: 1.3rem; font-weight: 700;">ğŸ“ ì „ì²´ ì‘ì—… íƒ€ì„ë¼ì¸</h3>
              <button class="btn btn-primary" style="padding: 10px 16px; font-size: 0.95rem;" onclick="openLogModal()">+ ìƒˆ ê¸°ë¡ ì‘ì„±</button>
            </div>
            <div id="log-timeline-root"></div>
          </div>
        </div>
      </div>
    </section>
  </main>
</div>

<div class="fab-menu">
  <div style="position:relative;"><button class="fab-btn fab-sub" onclick="openLogModal()">ğŸ“</button></div>
  <div style="position:relative;"><button class="fab-btn fab-main" onclick="openModal('í• ì¼')">+</button></div>
</div>

<div id="input-modal" class="modal-overlay">
  <div class="modal-box">
    <form id="todo-form">
      <input type="hidden" id="edit-mode" value="false">
      <input type="hidden" id="edit-id">
      <input type="hidden" id="origin-idea-id"> <div class="modal-header-custom">
        <span class="modal-title-custom" id="todo-modal-title">ìƒˆ í•­ëª©</span>
        <div id="edit-actions" style="display:none;">
          <button type="button" class="btn" id="btn-delete-modal" onclick="deleteItem()" style="color:#ef4444; background:#fee2e2; border:none; padding:8px 12px; border-radius:8px; font-weight:bold;">ğŸ—‘ï¸ ì‚­ì œ</button>
        </div>
      </div>

      <div class="modal-body-custom">
        <div class="form-grid">
          
          <div class="form-group">
            <label class="input-label">í•­ëª© ìœ í˜•</label>
            <div class="type-selector-wrapper" onchange="toggleFormFields()">
              <input type="radio" name="type" id="type-task" value="í•  ì¼" checked><label for="type-task">í•  ì¼</label>
              <input type="radio" name="type" id="type-idea" value="ì•„ì´ë””ì–´"><label for="type-idea">ğŸ’¡ ì•„ì´ë””ì–´</label>
              <input type="radio" name="type" id="type-bug" value="ë²„ê·¸"><label for="type-bug">ğŸ”¥ ë²„ê·¸</label>
              <input type="radio" name="type" id="type-mid" value="ì¤‘ê°„ ëª©í‘œ"><label for="type-mid">ğŸš© ì¤‘ê°„ ëª©í‘œ</label>
              <input type="radio" name="type" id="type-big" value="í° ëª©í‘œ"><label for="type-big">ğŸ† í° ëª©í‘œ</label>
            </div>
          </div>

          <div class="form-group" id="field-title">
            <label class="input-label">ì œëª©</label>
            <input type="text" id="input-title" class="styled-input" placeholder="ë¬´ì—‡ì„ í•´ì•¼ í•˜ë‚˜ìš”?" required autocomplete="off">
          </div>

          <div class="form-group" id="field-color" style="display:none;">
            <label class="input-label" id="label-color-theme">ë¶„ë¥˜ ì„ íƒ</label>
            
            <div id="color-picker-goal" class="color-chip-wrapper" style="display:none;">
                <label><input type="radio" name="color" value="#4f46e5" class="color-radio" checked><span class="color-chip-option">ì¸ë””ê³ </span></label>
                <label><input type="radio" name="color" value="#059669" class="color-radio"><span class="color-chip-option">ì—ë©”ë„ë“œ</span></label>
                <label><input type="radio" name="color" value="#db2777" class="color-radio"><span class="color-chip-option">í•‘í¬</span></label>
                <label><input type="radio" name="color" value="#d97706" class="color-radio"><span class="color-chip-option">ì— ë²„</span></label>
            </div>

            <div id="color-picker-idea" class="color-chip-wrapper" style="display:none;">
                <label><input type="radio" name="color" value="#db2777" class="color-radio"><span class="color-chip-option">ğŸ“ ë¸”ë¡œê·¸</span></label>
                <label><input type="radio" name="color" value="#2563eb" class="color-radio"><span class="color-chip-option">âš™ï¸ ì‹œìŠ¤í…œ</span></label>
                <label><input type="radio" name="color" value="#d97706" class="color-radio"><span class="color-chip-option">ğŸ§€ ì‚¬ì—…</span></label>
                <label><input type="radio" name="color" value="#64748b" class="color-radio" checked><span class="color-chip-option">ğŸ’­ ì¡ë‹´</span></label>
            </div>
          </div>

          <div class="form-group" id="field-parent">
            <label class="input-label" id="label-parent">ì—°ê²°ëœ ëª©í‘œ</label>
            <select id="input-connected-id" class="styled-input">
              <option value="">(ì„ íƒ ì—†ìŒ)</option>
            </select>
            <div style="font-size:0.8rem; color:#94a3b8; margin-top:4px;">* ìƒìœ„ ëª©í‘œë¥¼ ì„ íƒí•˜ë©´ êµ¬ì¡°í™”ë˜ì–´ ê´€ë¦¬ë©ë‹ˆë‹¤.</div>
          </div>

          <div class="form-group" id="field-detail">
            <label class="input-label">ìƒì„¸ ë‚´ìš©</label>
            <textarea id="input-detail"></textarea>
          </div>

          <div class="form-row">
            <div class="form-group" id="field-start-date" style="display:none;">
              <label class="input-label">ì‹œì‘ì¼</label>
              <input type="date" id="input-start" class="styled-input">
            </div>

            <div class="form-group" id="field-due-date">
              <label class="input-label">ë§ˆê°ì¼ / ì¼ì</label>
              <input type="date" id="input-due" class="styled-input">
            </div>

            <div class="form-group" id="field-priority">
              <label class="input-label">ìš°ì„ ìˆœìœ„</label>
              <select id="input-priority" class="styled-input">
                <option value="ë‚®ìŒ">ğŸŸ¢ ë‚®ìŒ (ì²œì²œíˆ)</option>
                <option value="ë³´í†µ" selected>ğŸ”µ ë³´í†µ (ì¼ë°˜ì )</option>
                <option value="ë†’ìŒ">ğŸ”´ ë†’ìŒ (ê¸‰í•¨!)</option>
                <option value="ê¸´ê¸‰">ğŸ”¥ ê¸´ê¸‰ (ì§€ê¸ˆ ë‹¹ì¥)</option>
              </select>
            </div>
          </div>
          
          <div id="related-history-section" style="display:none; margin-top:20px; padding-top:20px; border-top:1px dashed #cbd5e1;">
             <label class="input-label">ğŸ“‹ ì‘ì—… íˆìŠ¤í† ë¦¬</label>
             <div id="history-list-root" style="font-size:0.9rem; color:#64748b;"></div>
          </div>

          <div id="related-idea-section" style="display:none; margin-top:20px; padding:15px; background:#f0f9ff; border-radius:12px; border:1px solid #bae6fd;">
             <label class="input-label" style="color:#0369a1;">ğŸ’¡ ì—°ê²°ëœ ì•„ì´ë””ì–´</label>
             <div id="related-idea-root" style="font-size:0.9rem; color:#0c4a6e;"></div>
          </div>

        </div> </div> <div class="modal-footer-custom">
        <button type="button" class="btn-close-custom" onclick="closeModal('input-modal')">ë‹«ê¸°</button>
        <button type="submit" class="btn-save-custom">ğŸ’¾ ì €ì¥í•˜ê¸°</button>
      </div>

    </form>
  </div>
</div>

<div id="log-modal" class="custom-modal">
  <div class="modal-box">
    <h3 class="modal-title" id="log-modal-title" style="margin-top:0;">ì‘ì—… ê¸°ë¡</h3>
    <form id="log-form" class="admin-form-grid">
      <input type="hidden" id="log-edit-id"><input type="hidden" id="log-edit-mode" value="false">
      <div class="field admin-field-full"><label>ë‚ ì§œ</label><input type="date" id="log-date" required></div>
      <div class="field admin-field-full"><label>ì œëª© (ì„ íƒ)</label><input type="text" id="log-title"></div>
      <div class="field admin-field-full" style="background:#f0f9ff; padding:10px; border-radius:8px; border:1px solid #bae6fd;"><label style="color:#0284c7; font-weight:600;">ğŸ”— ê´€ë ¨ ì‘ì—… ì—°ë™ (ì„ íƒ)</label><select id="log-related-id" style="width:100%; border:1px solid #bae6fd;"><option value="">(ì—†ìŒ)</option></select><p style="font-size:0.75rem; color:#0ea5e9; margin:4px 0 0;">* ì´ ë¡œê·¸ë¥¼ íŠ¹ì • ì‘ì—…ê³¼ ì—°ê²°í•©ë‹ˆë‹¤.</p></div>
      <div class="field admin-field-full"><label>ë‚´ìš©</label><textarea id="log-content" required style="min-height:100px;"></textarea></div>
      <div class="field admin-field-full" id="log-idea-section" style="background:#f0fdf4; padding:16px; border-radius:12px; border:1px dashed #16a34a;"><label style="color:#15803d; font-weight:700;">ğŸ’¡ ì•„ì´ë””ì–´ (ì„ íƒ)</label><input type="text" id="log-idea-input" placeholder="ì—¬ê¸°ì— ì ìœ¼ë©´ ì•„ì´ë””ì–´ í•¨ì— ì¶”ê°€ë¨" style="background:#fff; border-color:#86efac;"></div>
      
      <div class="field admin-field-full" id="log-bug-section">
        <label>ğŸ ë²„ê·¸ ë°œê²¬ (ì„ íƒ)</label>
        <div style="display:flex; flex-direction:column; gap:8px;">
            <input type="text" id="log-bug-input" placeholder="ë²„ê·¸ ì œëª© (ì˜ˆ: ë¡œê·¸ì¸ ì‹œ 404 ì—ëŸ¬)" style="background:#fff;">
            <textarea id="log-bug-detail" placeholder="ë²„ê·¸ ìƒì„¸ ë‚´ìš© (ë°œìƒ ê²½ë¡œ, ì¦ìƒ ë“±)" style="background:#fff; min-height:60px;"></textarea>
        </div>
        <p style="font-size:0.75rem; color:#ef4444; margin:4px 0 0;">* ì…ë ¥ ì‹œ 'ë²„ê·¸' í•­ëª©ìœ¼ë¡œ ìë™ ë“±ë¡ë˜ë©°, í˜„ì¬ ë¡œê·¸ì™€ ì—°ë™ë©ë‹ˆë‹¤.</p>
      </div>

      <div class="field"><label>ì‹œê°„</label><input type="text" id="log-duration"></div>
      <div class="field"><label>íƒœê·¸</label><input type="text" id="log-tags"></div>
      <div class="field admin-field-full" style="margin-top:20px; display:flex; gap:10px;"><button type="submit" class="btn btn-primary" style="flex:1; justify-content:center; padding:12px;">ì €ì¥</button><button type="button" class="btn" onclick="closeModal('log-modal')" style="flex:1; justify-content:center; padding:12px;">ì·¨ì†Œ</button></div>
    </form>
  </div>
</div>

<script>
  window.CHEESE_ADMIN_ACTIVE_PAGE = "todo_manage";
  let g_goals=[], g_tasks=[], g_logs=[];

  document.addEventListener('DOMContentLoaded', loadAllData);

  // [ì¶”ê°€] ë²„íŠ¼ ë¡œë”© ìƒíƒœ í† ê¸€ í•¨ìˆ˜
  function toggleBtnLoading(btn, isLoading) {
    if (!btn) return;
    
    if (isLoading) {
      // ë¡œë”© ì‹œì‘: ì›ë˜ í…ìŠ¤íŠ¸ ì €ì¥ -> ìŠ¤í”¼ë„ˆ+ì €ì¥ì¤‘ í…ìŠ¤íŠ¸ë¡œ ë³€ê²½ -> ë¹„í™œì„±í™”
      btn.dataset.originalText = btn.innerHTML; 
      btn.style.width = getComputedStyle(btn).width; // í¬ê¸° ê³ ì • (ëœì»¹ê±°ë¦¼ ë°©ì§€)
      btn.classList.add('loading');
      btn.disabled = true;
      btn.innerHTML = `<span class="btn-spinner"></span> ì €ì¥ ì¤‘...`;
    } else {
      // ë¡œë”© ë: ì›ë˜ í…ìŠ¤íŠ¸ ë³µêµ¬ -> í™œì„±í™”
      btn.classList.remove('loading');
      btn.disabled = false;
      btn.innerHTML = btn.dataset.originalText;
      btn.style.width = ''; // í¬ê¸° ê³ ì • í•´ì œ
    }
  }
  
  async function loadAllData() {
    if(typeof showAdminLoading==='function') showAdminLoading("ë°ì´í„° ë™ê¸°í™” ì¤‘...");
    try {
      const res = await fetch(window.CHEESE_ADMIN_API_BASE + "?mode=getAllData");
      const json = await res.json();
      if(json.result === "success") {
        g_goals = json.goals; g_tasks = json.tasks; g_logs = json.logs||[];
        renderGoalTree(); renderBoardView(); renderBugView(); renderIdeaView(); renderLogs(); updateParentOptions();
      }
    } catch(e) { console.error(e); }
    finally { if(typeof hideAdminLoading==='function') hideAdminLoading(); }
  }

  // [ì¶”ê°€] í˜„ì¬ ì„ íƒëœ ì•„ì´ë””ì–´ íƒ­ (ê¸°ë³¸ê°’: ì „ì²´)
  let g_currentIdeaTab = 'all';
  
  // [ì¶”ê°€] ì•„ì´ë””ì–´ íƒ­ ì „í™˜ í•¨ìˆ˜
  function switchIdeaTab(tabName) {
    g_currentIdeaTab = tabName;
    
    // íƒ­ ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
    document.querySelectorAll('.idea-tab-btn').forEach(btn => btn.classList.remove('active'));
    document.getElementById('itab-' + tabName).classList.add('active');
    
    // ë·° ë‹¤ì‹œ ê·¸ë¦¬ê¸°
    renderIdeaView();
  }
  
  // ğŸš€ [ìˆ˜ì •] íƒ­ ì „í™˜ í•¨ìˆ˜
  function switchView(mode) {
    document.querySelectorAll('.view-tab-btn').forEach(btn => btn.classList.remove('active'));
    document.getElementById('btn-view-' + mode).classList.add('active');
    
    const containers = ['card', 'board', 'bug', 'idea', 'log'];
    containers.forEach(c => {
        document.getElementById('view-' + c + '-container').style.display = (c === mode) ? 'block' : 'none';
    });
    
    // íƒ­ ì „í™˜ ì‹œ ë·° ë¦¬ë Œë”ë§ (ìµœì‹  ìƒíƒœ ë°˜ì˜)
    if(mode === 'board') renderBoardView();
    if(mode === 'bug') renderBugView();
    if(mode === 'idea') renderIdeaView();
    if(mode === 'log') renderLogs();
  }

// ğŸš€ [ìˆ˜ì •] ê³„ì¸µí˜• ë·° (ë²„ê·¸ ìˆ¨ê¹€)
  function renderGoalTree() {
    const root = document.getElementById('goal-tree-root'); root.innerHTML = "";
    const bigGoals = g_goals.filter(g => g['ìœ í˜•'] === 'í° ëª©í‘œ');
    if(bigGoals.length===0) { root.innerHTML = `<div style="padding:40px;text-align:center;color:#94a3b8;">ë°ì´í„° ì—†ìŒ</div>`; return; }
    
    bigGoals.forEach(bg => {
      const themeColor = bg['ìƒ‰ìƒ'] || "#4f46e5";
      const card = document.createElement('div'); card.className = "goal-card";
      
      const header = document.createElement('div'); 
      header.className = "goal-card-header"; 
      header.style.background = `linear-gradient(135deg, ${themeColor} 0%, ${adjustColor(themeColor,-20)} 100%)`;
      
      header.onclick = function() {
        const body = card.querySelector('.mid-goal-group');
        const icon = header.querySelector('.toggle-icon');
        if (body.style.display === "none") { body.style.display = "block"; icon.textContent = "â–¼"; } 
        else { body.style.display = "none"; icon.textContent = "â–¶"; }
      };

      let dateHtml = ""; if (bg['ì‹œì‘ì¼'] || bg['ë§ˆê°ì¼']) { const s = bg['ì‹œì‘ì¼']?bg['ì‹œì‘ì¼'].split('T')[0]:''; const e = bg['ë§ˆê°ì¼']?bg['ë§ˆê°ì¼'].split('T')[0]:''; dateHtml = `<div class="goal-date-badge">ğŸ—“ ${s} ~ ${e}</div>`; }
      const descHtml = bg['ìƒì„¸ë‚´ìš©'] ? `<div class="goal-card-desc">${bg['ìƒì„¸ë‚´ìš©']}</div>` : '';
      
      header.innerHTML = `
        <div style="flex:1;">
          <div class="goal-card-title"><span class="toggle-icon">â–¶</span> ${bg['ì œëª©']}</div>
          ${dateHtml}${descHtml}
        </div>
        <div class="header-actions" onclick="event.stopPropagation()">
           <button class="action-btn" onclick="openEditModal('goal', '${bg.ID}')">âœï¸</button>
           <button class="action-btn" onclick="deleteItem('${bg.ID}')">ğŸ—‘ï¸</button>
        </div>
      `;
      card.appendChild(header);

      const body = document.createElement('div'); 
      body.className = "mid-goal-group";
      body.style.display = "none"; 

      const midGoals = g_goals.filter(m => m['ìƒìœ„ID'] === bg.ID);
      midGoals.forEach(mg => {
        const midItem = document.createElement('div'); 
        midItem.className = "mid-goal-item"; 
        midItem.style.borderLeftColor = themeColor;
        
        const midDesc = mg['ìƒì„¸ë‚´ìš©'] ? `<span style="font-weight:400; font-size:0.85rem; color:#64748b; margin-left:8px;">${mg['ìƒì„¸ë‚´ìš©']}</span>` : '';
        
        const midHeader = document.createElement('div');
        midHeader.className = "mid-goal-header";
        midHeader.onclick = function() { toggleDisplay(this); };
        midHeader.innerHTML = `<span>ğŸš© ${mg['ì œëª©']} ${midDesc}</span><div onclick="event.stopPropagation()" class="row-actions"><button class="row-btn" onclick="openEditModal('goal', '${mg.ID}')">âœï¸</button><button class="row-btn delete" onclick="deleteItem('${mg.ID}')">ğŸ—‘ï¸</button></div>`;
        midItem.appendChild(midHeader);

        const contentWrapper = document.createElement('div');
        contentWrapper.style.display = "block"; 

        const relatedIdeas = g_tasks.filter(t => t['ìœ í˜•'] === 'ì•„ì´ë””ì–´' && String(t['ì—°ê²°_ì¤‘ê°„ëª©í‘œID']||"").includes(mg.ID));
        if (relatedIdeas.length > 0) {
          const slider = document.createElement('div');
          slider.className = "mid-idea-slider"; 
          
          let sliderHtml = "";
          relatedIdeas.forEach(idea => {
             const iDate = idea['ê¸°í•œ'] ? idea['ê¸°í•œ'].split('T')[0] : '';
             const iDesc = (idea['ìƒì„¸ë‚´ìš©']||"").replace(/<[^>]*>?/gm, ''); 
             sliderHtml += `
               <div class="mid-idea-card-mini" onclick="openEditModal('idea', '${idea.ID}')">
                 <div class="mic-date">ğŸ’¡ ${iDate}</div>
                 <div class="mic-title">${idea['ì œëª©']}</div>
                 <div class="mic-desc">${iDesc || '(ë‚´ìš© ì—†ìŒ)'}</div>
               </div>
             `;
          });
          slider.innerHTML = sliderHtml;
          contentWrapper.appendChild(slider);
        }

        const taskList = document.createElement('div'); 
        taskList.className = "task-list";
        // ğŸš€ ë²„ê·¸ ì œì™¸ í•„í„° ì ìš©
        const tasks = g_tasks.filter(t => 
            String(t['ì—°ê²°_ì¤‘ê°„ëª©í‘œID']||"").includes(mg.ID) 
            && t['ìœ í˜•'] !== 'ì•„ì´ë””ì–´' 
            && t['ìœ í˜•'] !== 'ë²„ê·¸' 
        );        
        if(tasks.length > 0) tasks.forEach(t => taskList.appendChild(createTaskRow(t)));
        else if(relatedIdeas.length === 0) taskList.innerHTML = `<div style="padding:15px;color:#cbd5e1;font-size:0.85rem;">í•  ì¼ ì—†ìŒ</div>`;
        
        contentWrapper.appendChild(taskList);
        midItem.appendChild(contentWrapper);
        body.appendChild(midItem);
      });
      card.appendChild(body); root.appendChild(card);
    });
  }
  
  function createTaskRow(t) {
    const container = document.createElement('div'); const row = document.createElement('div'); row.className = "task-row";
    row.onclick = function() { openEditModal('task', t.ID); };
    const isDone = t['ìƒíƒœ'] === 'ì™„ë£Œ';
    const relatedCount = g_logs.filter(l => l['ê´€ë ¨_ëª©í‘œID'] === t.ID).length;
    const badgeHtml = relatedCount > 0 ? `<span class="log-count-badge">ğŸ“ ${relatedCount}</span>` : '';
    const prefix = t['ìœ í˜•'] === 'ë²„ê·¸' ? '<span style="color:#ef4444;font-weight:bold;margin-right:4px;">[BUG]</span> ' : '';
    row.innerHTML = `<div class="check-circle ${isDone?'checked':''}" onclick="event.stopPropagation(); toggleStatus('${t.ID}','${isDone?'ëŒ€ê¸°':'ì™„ë£Œ'}')"></div><div style="flex:1; text-decoration:${isDone?'line-through':''}; color:${isDone?'#cbd5e1':'#334155'}; font-weight:500;">${prefix}${t['ì œëª©']} ${t['ìƒì„¸ë‚´ìš©']?'<span style="font-size:0.75rem;color:#94a3b8;margin-left:4px;">ğŸ“</span>':''} ${badgeHtml}</div>`;
    container.appendChild(row); return container;
  }

  // ğŸš€ [ìˆ˜ì •] ë³´ë“œ ë·° (3ë‹¨ ì¹´ë“œí˜•)
  function renderBoardView() {
    const cols = {
      'high': { active: document.getElementById('board-col-high'), done: document.getElementById('board-col-high-done'), doneCount: 0 },
      'normal': { active: document.getElementById('board-col-normal'), done: document.getElementById('board-col-normal-done'), doneCount: 0 },
      'low': { active: document.getElementById('board-col-low'), done: document.getElementById('board-col-low-done'), doneCount: 0 }
    };

    // ì´ˆê¸°í™”
    Object.values(cols).forEach(c => { 
        if(c.active) c.active.innerHTML = ""; 
        if(c.done) c.done.innerHTML = ""; 
    });

    // ë²„ê·¸ ì œì™¸í•œ í•  ì¼ë§Œ í‘œì‹œ
    const tasks = g_tasks.filter(t => t['ìœ í˜•'] !== 'ì•„ì´ë””ì–´' && t['ìœ í˜•'] !== 'ë²„ê·¸');
    
    // ë‚ ì§œìˆœ ì •ë ¬
    tasks.sort((a, b) => {
        const dateA = a['ê¸°í•œ'] ? new Date(a['ê¸°í•œ']) : new Date('9999-12-31');
        const dateB = b['ê¸°í•œ'] ? new Date(b['ê¸°í•œ']) : new Date('9999-12-31');
        return dateA - dateB;
    });

    tasks.forEach(t => {
        let pKey = 'low';
        const priority = t['ìš°ì„ ìˆœìœ„'] || 'ë³´í†µ';
        if (priority === 'ë†’ìŒ') pKey = 'high';
        else if (priority === 'ë³´í†µ') pKey = 'normal';
        
        const isDone = t['ìƒíƒœ'] === 'ì™„ë£Œ';
        const card = createBoardCard(t);
        
        if (cols[pKey]) {
            if (isDone) {
                cols[pKey].done.appendChild(card);
                cols[pKey].doneCount++;
            } else {
                cols[pKey].active.appendChild(card);
            }
        }
    });

    if(document.getElementById('count-high-done')) document.getElementById('count-high-done').innerText = `(${cols.high.doneCount})`;
    if(document.getElementById('count-normal-done')) document.getElementById('count-normal-done').innerText = `(${cols.normal.doneCount})`;
    if(document.getElementById('count-low-done')) document.getElementById('count-low-done').innerText = `(${cols.low.doneCount})`;
  }

  function createBoardCard(item) {
      const el = document.createElement('div');
      const isDone = item['ìƒíƒœ'] === 'ì™„ë£Œ';
      el.className = `board-card ${isDone ? 'done' : ''}`;
      el.onclick = () => openEditModal('task', item.ID);

      let dateHtml = "";
      if (item['ê¸°í•œ']) {
          const d = new Date(item['ê¸°í•œ']);
          const today = new Date(); today.setHours(0,0,0,0);
          const isOverdue = !isDone && d < today;
          const dateStr = `${d.getMonth()+1}/${d.getDate()}`;
          dateHtml = `<span class="board-date-badge ${isOverdue ? 'board-overdue' : ''}">${isOverdue?'ğŸš¨ ':''}ğŸ“… ${dateStr}</span>`;
      }

      const title = item['ì œëª©'] || "(ì œëª© ì—†ìŒ)";
      el.innerHTML = `<div class="board-card-title">${title}</div><div class="board-card-meta">${dateHtml}<span>${item['ìƒíƒœ']}</span></div>`;
      return el;
  }

  function toggleBoardCompleted(priority) {
      const el = document.getElementById(`board-col-${priority}-done`);
      if(el) el.style.display = (el.style.display === 'none') ? 'flex' : 'none';
  }

// ğŸš€ [ìˆ˜ì •] ë²„ê·¸ íŠ¸ë˜ì»¤
  function renderBugView() {
    const root = document.getElementById('bug-grid-root'); root.innerHTML = "";
    const showArchive = document.getElementById('toggle-bug-archive') ? document.getElementById('toggle-bug-archive').checked : false;

    const bugs = g_tasks.filter(t => {
      if (t['ìœ í˜•'] !== 'ë²„ê·¸') return false;
      if (showArchive) return t['ìƒíƒœ'] === 'ì™„ë£Œ'; 
      else return t['ìƒíƒœ'] !== 'ì™„ë£Œ'; 
    });
    
    bugs.sort((a,b) => (b['ID'] > a['ID'] ? 1 : -1));

    if(bugs.length === 0) { 
        root.innerHTML = `<div style="grid-column:1/-1; text-align:center; padding:60px; color:#cbd5e1;">${showArchive ? 'í•´ê²°ëœ ë²„ê·¸ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.' : 'ë°œê²¬ëœ ë²„ê·¸ê°€ ì—†ìŠµë‹ˆë‹¤! ğŸ‰'}</div>`; 
        return; 
    }

    bugs.forEach(t => {
      const card = document.createElement('div');
      const isWorking = t['ìƒíƒœ'] === 'ì§„í–‰ì¤‘';
      const isDone = t['ìƒíƒœ'] === 'ì™„ë£Œ';
      card.className = `bug-card ${isWorking ? 'working' : ''}`;
      
      let parentTitle = "";
      if (t['ì—°ê²°_ì¤‘ê°„ëª©í‘œID']) {
        const parent = g_tasks.find(x => x.ID === t['ì—°ê²°_ì¤‘ê°„ëª©í‘œID']) || g_goals.find(x => x.ID === t['ì—°ê²°_ì¤‘ê°„ëª©í‘œID']);
        if (parent) parentTitle = parent['ì œëª©'];
      }
      
      const plainText = (t['ìƒì„¸ë‚´ìš©'] || "ë‚´ìš© ì—†ìŒ").replace(/<[^>]*>?/gm, '').slice(0, 100) + "...";
      const deleteBtn = `<button class="bug-btn delete-bug" onclick="deleteItem('${t.ID}')" style="flex:0 0 auto; width:36px; background:#fff1f2; color:#ef4444; margin-left:4px;" title="ì‚­ì œ">ğŸ—‘ï¸</button>`;

      let buttonsHtml = "";
      if (isDone) {
          buttonsHtml = `<button class="bug-btn restore" onclick="toggleStatus('${t.ID}', 'ëŒ€ê¸°')">â†©ï¸ ë¯¸í•´ê²°/ë³µêµ¬</button>${deleteBtn}`;
      } else if (isWorking) {
          buttonsHtml = `<button class="bug-btn restore" onclick="toggleStatus('${t.ID}', 'ëŒ€ê¸°')">â†©ï¸ ì·¨ì†Œ</button><button class="bug-btn solve" onclick="toggleStatus('${t.ID}', 'ì™„ë£Œ')">âœ… í•´ê²° ì™„ë£Œ!</button>${deleteBtn}`;
      } else {
          buttonsHtml = `<button class="bug-btn check" onclick="toggleStatus('${t.ID}', 'ì§„í–‰ì¤‘')">ğŸ” í™•ì¸ ì‹œì‘</button><button class="bug-btn solve" onclick="toggleStatus('${t.ID}', 'ì™„ë£Œ')">ë°”ë¡œ í•´ê²°</button>${deleteBtn}`;
      }

      card.innerHTML = `
        ${isWorking ? `<div class="bug-status-badge">ğŸ”¥ í™•ì¸ì¤‘</div>` : ''} 
        <div class="bug-content" onclick="openEditModal('task', '${t.ID}')" style="cursor:pointer; flex-grow:1;">
          <div class="bug-parent-info">${parentTitle ? `<span>ğŸ”— ${parentTitle}</span>` : '<span>(ì—°ë™ ì‘ì—… ì—†ìŒ)</span>'}</div>
          <div class="bug-title">${t['ì œëª©']}</div>
          <div class="bug-body">${plainText}</div>
        </div>
        <div class="bug-footer">${buttonsHtml}</div>
      `;
      root.appendChild(card);
    });
  }

// [ìˆ˜ì •] ì•„ì´ë””ì–´ ë·° ë Œë”ë§ (íƒ­ í•„í„° + ì¹´ë“œ ë¦¬ìŠ¤íŠ¸)
function renderIdeaView() {
  const root = document.getElementById('idea-list-root');
  root.innerHTML = "";

  const sortMode = document.getElementById('idea-sort-select').value;
  
  // 1. ì „ì²´ ì•„ì´ë””ì–´ ë°ì´í„° ì¤€ë¹„ (í• ì¼ ì¤‘ ë¶€ëª¨ ì—†ëŠ” ê³ ì•„ í¬í•¨)
  let rawIdeas = g_tasks.filter(t => {
    if (t['ìœ í˜•'] === 'ì•„ì´ë””ì–´') return true;
    // ê³ ì•„ íƒœìŠ¤í¬(ë¶€ëª¨X í˜¹ì€ ë¶€ëª¨ê°€ í°ëª©í‘œ)ë„ ì•„ì´ë””ì–´ë¡œ ì·¨ê¸‰
    if (t['ìœ í˜•'] === 'í•  ì¼') {
        const parentId = t['ì—°ê²°_ì¤‘ê°„ëª©í‘œID'];
        if (!parentId || parentId.trim() === "" || parentId.startsWith("G_")) return true;
    }
    return false;
  });

  // 2. íƒ­ì— ë”°ë¥¸ í•„í„°ë§
  let filteredIdeas = rawIdeas.filter(item => {
    const realizedId = item['ì—°ê²°_ì¤‘ê°„ëª©í‘œID']; 
    // ì‹¤í˜„ ì—¬ë¶€ í™•ì¸ (T_ ë˜ëŠ” B_ì™€ ì—°ê²°ëœ ê²½ìš°)
    // ì£¼ì˜: ê³ ì•„ íƒœìŠ¤í¬ëŠ” ì—°ê²°IDê°€ ì—†ìœ¼ë¯€ë¡œ ë¯¸ì‹¤í˜„ìœ¼ë¡œ ê°„ì£¼ë¨
    const isRealized = realizedId && (realizedId.startsWith('T_') || realizedId.startsWith('B_'));
    const color = item['ìƒ‰ìƒ'] || '#64748b'; // ìƒ‰ìƒ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’(ì¡ë‹´)

    // [ì‹¤í˜„ë¨] íƒ­: ì¹´í…Œê³ ë¦¬ ìƒê´€ì—†ì´ ì‹¤í˜„ëœ ê²ƒë§Œ ëª¨ì•„ë³´ê¸°
    if (g_currentIdeaTab === 'realized') {
      return isRealized; 
    }

    // ë‚˜ë¨¸ì§€ íƒ­: 'ì‹¤í˜„ë˜ì§€ ì•Šì€ ê²ƒ'ë§Œ ë³´ì—¬ì¤Œ (ë³„ë„ ê´€ë¦¬ ìš”ì²­ ë°˜ì˜)
    if (isRealized) return false;

    // ì¹´í…Œê³ ë¦¬ë³„ í•„í„°
    if (g_currentIdeaTab === 'all') return true; // ì „ì²´ (ë¯¸ì‹¤í˜„)
    if (g_currentIdeaTab === 'blog') return color === '#db2777';
    if (g_currentIdeaTab === 'system') return color === '#2563eb';
    if (g_currentIdeaTab === 'biz') return color === '#d97706';
    if (g_currentIdeaTab === 'etc') return (color === '#64748b' || !color); // ê¸°íƒ€ or ìƒ‰ìƒì—†ìŒ
    
    return true;
  });

  // 3. ì •ë ¬ (ë‚ ì§œìˆœ)
  filteredIdeas.sort((a, b) => {
    const dateA = a['ê¸°í•œ'] ? new Date(a['ê¸°í•œ']).getTime() : 0;
    const dateB = b['ê¸°í•œ'] ? new Date(b['ê¸°í•œ']).getTime() : 0;
    if (sortMode === 'oldest') return (dateA - dateB) || (a.ID - b.ID);
    return (dateB - dateA) || (b.ID - a.ID); // ìµœì‹ ìˆœ ê¸°ë³¸
  });

  // 4. ë°ì´í„° ì—†ìŒ ì²˜ë¦¬
  if (filteredIdeas.length === 0) {
    let msg = "ë“±ë¡ëœ ì•„ì´ë””ì–´ê°€ ì—†ìŠµë‹ˆë‹¤.";
    if (g_currentIdeaTab === 'realized') msg = "ì•„ì§ ì‹¤í˜„ëœ ì•„ì´ë””ì–´ê°€ ì—†ìŠµë‹ˆë‹¤. ğŸš€";
    root.innerHTML = `<div style="grid-column:1/-1; text-align:center; padding:60px; color:#cbd5e1;">${msg}</div>`;
    return;
  }

  // 5. ì¹´ë“œ ë Œë”ë§
  filteredIdeas.forEach(item => {
    const card = document.createElement('div');
    
    // ì¹´í…Œê³ ë¦¬ í´ë˜ìŠ¤ ë§¤í•‘
    let catClass = 'cat-etc';
    const c = item['ìƒ‰ìƒ'];
    if (c === '#db2777') catClass = 'cat-blog';
    else if (c === '#2563eb') catClass = 'cat-system';
    else if (c === '#d97706') catClass = 'cat-biz';
    
    const isRealized = (g_currentIdeaTab === 'realized');
    card.className = `idea-card-item ${catClass} ${isRealized ? 'is-realized' : ''}`;
    
    // ë‚´ìš© ì²˜ë¦¬
    const dateStr = item['ê¸°í•œ'] ? item['ê¸°í•œ'].split('T')[0] : '';
    const plainText = (item['ìƒì„¸ë‚´ìš©'] || "ë‚´ìš© ì—†ìŒ").replace(/<[^>]*>?/gm, '').slice(0, 100) + "...";
    
    // ë±ƒì§€ (ì¹´í…Œê³ ë¦¬ëª…)
    let badgeLabel = "ğŸ’­ ì¡ë‹´";
    let badgeColor = "#64748b";
    if (catClass === 'cat-blog') { badgeLabel = "ğŸ“ ë¸”ë¡œê·¸"; badgeColor = "#db2777"; }
    else if (catClass === 'cat-system') { badgeLabel = "âš™ï¸ ì‹œìŠ¤í…œ"; badgeColor = "#2563eb"; }
    else if (catClass === 'cat-biz') { badgeLabel = "ğŸ§€ ì‚¬ì—…"; badgeColor = "#d97706"; }
    if (isRealized) { badgeLabel = "ğŸš€ ì‹¤í˜„ë¨"; badgeColor = "#10b981"; }

    // ë²„íŠ¼ HTML
    let buttons = "";
    if (isRealized) {
      buttons = `<button class="btn" style="font-size:0.8rem; background:#fff; border:1px solid #cbd5e1;" onclick="event.stopPropagation(); cancelRealization('${item.ID}')">â†©ï¸ ì‹¤í˜„ ì·¨ì†Œ</button>`;
    } else {
      buttons = `<button class="btn" style="font-size:0.8rem; background:#eff6ff; color:#3b82f6; border:1px solid #bfdbfe; font-weight:700;" onclick="event.stopPropagation(); convertIdeaToTask('${item.ID}')">âš¡ ì‹¤í˜„í•˜ê¸°</button>`;
    }

    card.innerHTML = `
      <div class="ici-header">
        <span class="ici-badge" style="background:${badgeColor}">${badgeLabel}</span>
        <div class="ici-date">ğŸ“… ${dateStr}</div>
      </div>
      <div class="ici-title">${item['ì œëª©']}</div>
      <div class="ici-body">${plainText}</div>
      <div class="ici-footer">
        ${buttons}
        <button class="row-btn" style="font-size:1rem;" onclick="event.stopPropagation(); openEditModal('idea', '${item.ID}')">âœï¸</button>
      </div>
    `;
    
    // ì¹´ë“œ ì „ì²´ í´ë¦­ ì‹œ ìˆ˜ì •ì°½
    card.onclick = () => openEditModal('idea', item.ID);
    
    root.appendChild(card);
  });
}

  // ì•„ì´ë””ì–´ ì‹¤í˜„ ì·¨ì†Œ
  async function cancelRealization(ideaId) {
      if(!confirm("ì‹¤í˜„ ìƒíƒœë¥¼ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n(ì—°ê²°ëœ ì‘ì—…ê³¼ì˜ ê³ ë¦¬ë¥¼ ëŠìŠµë‹ˆë‹¤.)")) return;
      if(typeof showAdminLoading === 'function') showAdminLoading("ì·¨ì†Œ ì¤‘...");
      try {
          await fetch(window.CHEESE_ADMIN_API_BASE, { method: "POST", body: JSON.stringify({ mode: "editItem", id: ideaId, connectedId: "" }) });
          loadAllData(); 
      } catch(e) { console.error(e); alert("ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."); } 
      finally { if(typeof hideAdminLoading === 'function') hideAdminLoading(); }
  }

// [ìˆ˜ì •] ì•„ì´ë””ì–´ ì‹¤í˜„ (ë‚ ì§œ ê¼¬ì„ ë°©ì§€ ë¡œì§ ì ìš©)
  function convertIdeaToTask(ideaId) {
    const idea = g_tasks.find(t => t.ID === ideaId); 
    if (!idea) return;

    // 1. ëª¨ë‹¬ ì—´ê¸° (ì´ë•Œ openModal í•¨ìˆ˜ê°€ ë‚ ì§œë¥¼ 'ì˜¤ëŠ˜'ë¡œ ìë™ ì´ˆê¸°í™”í•¨)
    openModal('í• ì¼');

    // 2. ë°ì´í„° ì—°ë™
    document.getElementById('origin-idea-id').value = ideaId; // ì‹¤í˜„ í›„ ì—°ê²°ì„ ìœ„í•´ ID ì €ì¥
    document.getElementById('input-title').value = idea['ì œëª©']; // ì œëª©ì€ ê·¸ëŒ€ë¡œ ê°€ì ¸ì˜´
    
    // 3. [ì¤‘ìš”] ë‚ ì§œ ì²˜ë¦¬
    // ì•„ì´ë””ì–´ì˜ 'ê¸°í•œ'(ì‘ì„±ì¼)ì„ ê°€ì ¸ì˜¤ì§€ ì•Šê³ , openModalì´ ì„¤ì •í•œ 'ì˜¤ëŠ˜' ë‚ ì§œë¥¼ ê·¸ëŒ€ë¡œ ë‘¡ë‹ˆë‹¤.
    // ë§Œì•½ ëª…ì‹œì ìœ¼ë¡œ 'ë‚´ì¼' ë“±ìœ¼ë¡œ ì„¤ì •í•˜ê³  ì‹¶ë‹¤ë©´ ì—¬ê¸°ì„œ ìˆ˜ì • ê°€ëŠ¥í•©ë‹ˆë‹¤.
    // ì˜ˆ: document.getElementById('input-due').value = "2026-12-31"; 

    // 4. ìƒì„¸ ë‚´ìš©ì— 'ì•„ì´ë””ì–´ ì¶œì²˜'ì™€ 'ìµœì´ˆ êµ¬ìƒì¼' ê¸°ë¡
    const ideaDate = idea['ê¸°í•œ'] ? idea['ê¸°í•œ'].split('T')[0] : 'ë‚ ì§œ ë¯¸ìƒ';
    const memoContent = `
      <div style="background:#f0f9ff; padding:12px; border-left:4px solid #3b82f6; border-radius:4px; margin-bottom:15px; color:#1e40af;">
        <div style="font-weight:700; display:flex; justify-content:space-between;">
          <span>ğŸš€ Design Memo Origin</span>
          <span style="font-size:0.8rem; font-weight:400; color:#60a5fa;">ìµœì´ˆ êµ¬ìƒ: ${ideaDate}</span>
        </div>
        <div style="margin-top:4px; font-size:0.9rem;">${idea['ì œëª©']}</div>
        <div style="font-size:0.8rem; margin-top:4px; color:#93c5fd;">ì´ ì‘ì—…ì€ ì•„ì´ë””ì–´ í•¨ì—ì„œ ì‹¤í˜„ë˜ì—ˆìŠµë‹ˆë‹¤.</div>
      </div>
      ${idea['ìƒì„¸ë‚´ìš©'] || ''}
    `;
    
    $('#input-detail').summernote('code', memoContent);
  }

// ğŸš€ [ìˆ˜ì •] ë¡œê·¸ ë Œë”ë§ (ë‚ ì§œ ë°€ë¦¼ í•´ê²° + ìµœì‹ ìˆœ ì •ë ¬ ì¶”ê°€)
  function renderLogs() {
    const root = document.getElementById('log-timeline-root'); root.innerHTML = "";
    if(g_logs.length === 0) { root.innerHTML = `<div style="color:#cbd5e1; font-size:0.9rem; text-align:center; padding:20px;">ì‘ì—… ë¡œê·¸ê°€ ì—†ìŠµë‹ˆë‹¤.</div>`; return; }

    // [ì¶”ê°€] ë¡œê·¸ë¥¼ ë‚ ì§œ ë‚´ë¦¼ì°¨ìˆœ(ìµœì‹ ìˆœ) -> ID ë‚´ë¦¼ì°¨ìˆœ(ìµœì‹ ìˆœ)ìœ¼ë¡œ ë¯¸ë¦¬ ì •ë ¬
    // ì´ë ‡ê²Œ í•˜ë©´ ê·¸ë£¹í•‘í•  ë•Œ ë‚´ë¶€ ì•„ì´í…œë“¤ë„ ìµœì‹ ìˆœìœ¼ë¡œ ì •ë ¬ë¨
    g_logs.sort((a, b) => {
        const da = new Date(a['ë‚ ì§œ']);
        const db = new Date(b['ë‚ ì§œ']);
        return db - da || b.ID - a.ID; 
    });
    
    const groupedLogs = {};
    g_logs.forEach(log => {
        let dateKey = 'ë‚ ì§œ ì—†ìŒ';
        if (log['ë‚ ì§œ']) {
            // [ìˆ˜ì •] ë‹¨ìˆœ substringì€ UTC ê¸°ì¤€ìœ¼ë¡œ ì˜ë¼ì„œ í•˜ë£¨ ì „ìœ¼ë¡œ ë°€ë¦´ ìˆ˜ ìˆìŒ.
            // new Dateë¡œ ì „ì²´ ì‹œê°„ì„ íŒŒì‹±í•œ ë’¤ ë¡œì»¬ ì—°/ì›”/ì¼ì„ ê°€ì ¸ì™€ì•¼ í•¨.
            const d = new Date(log['ë‚ ì§œ']);
            if (!isNaN(d.getTime())) {
                const year = d.getFullYear();
                const month = String(d.getMonth() + 1).padStart(2, '0');
                const day = String(d.getDate()).padStart(2, '0');
                dateKey = `${year}-${month}-${day}`;
            } else {
                 // íŒŒì‹± ì‹¤íŒ¨ ì‹œ fallback
                 dateKey = log['ë‚ ì§œ'].substring(0, 10);
            }
        }
        if (!groupedLogs[dateKey]) groupedLogs[dateKey] = [];
        groupedLogs[dateKey].push(log);
    });

    const sortedDates = Object.keys(groupedLogs).sort().reverse();
    sortedDates.forEach(date => {
        const divider = document.createElement('div'); divider.className = "log-date-divider";
        let dayOfWeek = ""; try { dayOfWeek = new Date(date.replace(/-/g,'/')).toLocaleDateString('ko-KR', { weekday: 'short' }); } catch(e){}
        divider.innerHTML = `<span class="log-date-badge">ğŸ“… ${date} (${dayOfWeek})</span>`;
        root.appendChild(divider);

        // ì´ë¯¸ g_logsë¥¼ ì •ë ¬í–ˆìœ¼ë¯€ë¡œ ì—¬ê¸°ì„œëŠ” ìˆœì„œëŒ€ë¡œ ë¿Œë¦¬ë©´ ë¨ (ìµœì‹  = ìœ„)
        groupedLogs[date].forEach(log => {
            const item = document.createElement('div'); item.className = "log-item";
            const title = log['ì œëª©'] ? `<div class="log-title" style="font-weight:700; font-size:0.95rem; margin-bottom:4px;">${log['ì œëª©']}</div>` : '';
            let relatedHtml = "";
            if(log['ê´€ë ¨_ëª©í‘œID']) {
                const relTask = g_tasks.find(t => t.ID === log['ê´€ë ¨_ëª©í‘œID']) || g_goals.find(g => g.ID === log['ê´€ë ¨_ëª©í‘œID']);
                if(relTask) {
                    if (relTask['ìœ í˜•'] === 'ë²„ê·¸') relatedHtml = `<div class="log-related" style="background:#fecaca; color:#b91c1c; border:1px solid #f87171; padding:2px 8px; border-radius:4px; font-size:0.75rem; margin-bottom:6px; display:inline-block;">ğŸ ë²„ê·¸ Fix: ${relTask['ì œëª©']}</div>`; 
                    else relatedHtml = `<div class="log-related" style="background:#ecfdf5; color:#059669; padding:2px 8px; border-radius:4px; font-size:0.75rem; margin-bottom:6px; display:inline-block;">ğŸ“Œ ê´€ë ¨: ${relTask['ì œëª©']}</div>`; 
                }
            }
            const content = (log['ë‚´ìš©'] || "").replace(/\n/g, '<br>');
            item.innerHTML = `
                <div class="log-dot"></div>
                <div class="log-card">
                    <div class="log-header" style="margin-bottom: 4px;">
                        <div class="log-time">${log['ì†Œìš”ì‹œê°„'] ? `â± ${log['ì†Œìš”ì‹œê°„']}` : ''}</div>
                        <div class="log-actions"><button class="row-btn" onclick="openEditLog('${log.ID}')">âœï¸</button><button class="row-btn delete" onclick="deleteItem('${log.ID}')">ğŸ—‘ï¸</button></div>
                    </div>
                    ${relatedHtml}${title}<div class="log-body" style="font-size:0.9rem; color:#475569; line-height:1.6;">${content}</div>
                    ${log['íƒœê·¸'] ? `<div style="margin-top:8px;"><span class="log-tag" style="font-size:0.75rem; color:#3b82f6; background:#eff6ff; padding:2px 8px; border-radius:4px;">#${log['íƒœê·¸']}</span></div>` : ''}
                </div>`;
            root.appendChild(item);
        });
    });
  }

  function adjustColor(color, amount) { return color; } 
  function toggleDisplay(el) { const next = el.nextElementSibling; if(next) next.style.display = next.style.display==="none"?"block":"none"; }
  function closeModal(id) { document.getElementById(id).classList.remove('open'); }

  function updateLogTaskOptions(selectedId = "") {
    const select = document.getElementById('log-related-id'); select.innerHTML = '<option value="">(ì—†ìŒ)</option>';
    const tasks = g_tasks.filter(t => (t['ìœ í˜•'] === 'í• ì¼' || t['ìœ í˜•'] === 'ë²„ê·¸') && t['ìƒíƒœ'] !== 'ì™„ë£Œ');
    if(tasks.length > 0) { const group = document.createElement('optgroup'); group.label = "ì§„í–‰ ì¤‘ì¸ ì‘ì—… (í• ì¼/ë²„ê·¸)"; tasks.forEach(t => { const op = document.createElement('option'); op.value = t.ID; const prefix = t['ìœ í˜•'] === 'ë²„ê·¸' ? '[ğŸë²„ê·¸] ' : ''; op.textContent = prefix + t['ì œëª©']; group.appendChild(op); }); select.appendChild(group); }
    const mids = g_goals.filter(g => g['ìœ í˜•'] === 'ì¤‘ê°„ ëª©í‘œ');
    if(mids.length > 0) { const group2 = document.createElement('optgroup'); group2.label = "ì¤‘ê°„ ëª©í‘œ"; mids.forEach(m => { const op = document.createElement('option'); op.value = m.ID; op.textContent = m['ì œëª©']; group2.appendChild(op); }); select.appendChild(group2); }
    if(selectedId) select.value = selectedId;
  }

  function openLogModal() {
    document.getElementById('log-modal').classList.add('open'); 
    
    // [ìˆ˜ì •] valueAsDate = new Date()ëŠ” UTC ê¸°ì¤€ì´ë¼ ìƒˆë²½ì— ì‘ì„± ì‹œ ë‚ ì§œê°€ ì–´ì œë¡œ ë°€ë¦¼
    // ë¡œì»¬ ì‹œê°„ëŒ€ ê¸°ì¤€ ì˜¤ëŠ˜ ë‚ ì§œ ë¬¸ìì—´(YYYY-MM-DD)ì„ ì§ì ‘ ì£¼ì…
    const now = new Date();
    const localDate = new Date(now.getTime() - (now.getTimezoneOffset() * 60000)).toISOString().split('T')[0];
    document.getElementById('log-date').value = localDate;
    
    document.getElementById('log-edit-mode').value="false";
    document.getElementById('log-form').reset(); document.getElementById('log-idea-section').style.display='block'; updateLogTaskOptions();
  }

  function toggleEditMode(isEdit) {
    const form = document.getElementById('todo-form');
    // Select all inputs to disable/enable
    const inputs = form.querySelectorAll('input, select, textarea');
    
    if (isEdit) {
      // Enable inputs
      inputs.forEach(el => el.disabled = false);
      
      // Show 'edit actions' which contains the Delete button
      const editActions = document.getElementById('edit-actions');
      if(editActions) editActions.style.display = 'flex';
      
      // Initialize or Enable Summernote
      if (!$('#input-detail').summernote('exists')) {
        $('#input-detail').summernote({ height: 250, toolbar: [['style', ['bold', 'italic', 'underline', 'clear']], ['font', ['strikethrough']], ['para', ['ul', 'ol']], ['insert', ['link', 'picture']], ['view', ['fullscreen', 'codeview']]] });
      } else {
        $('#input-detail').summernote('enable');
      }
    } else {
      // Disable inputs (View Mode)
      inputs.forEach(el => el.disabled = true);
      
      // Hide delete button container
      const editActions = document.getElementById('edit-actions');
      if(editActions) editActions.style.display = 'none';
      
      // Disable Summernote
      if ($('#input-detail').summernote('exists')) {
        $('#input-detail').summernote('disable');
      }
    }
  }

function openModal(type) {
  document.getElementById('input-modal').classList.add('open'); 
  document.getElementById('todo-modal-title').textContent = "ìƒˆ í•­ëª© ë“±ë¡"; 
  document.getElementById('edit-mode').value = "false";
  // ìˆ¨ê²¨ì§„ ìš”ì†Œ ì´ˆê¸°í™”
  const delBtn = document.getElementById('btn-delete-modal');
  if(delBtn) delBtn.style.display = "none";
   
  document.getElementById('related-history-section').style.display = "none";
  document.getElementById('related-idea-section').style.display = "none";
  
  // [ìˆ˜ì •] origin-id -> edit-id ë¡œ ë³€ê²½
  document.getElementById('edit-id').value = ""; 
  document.getElementById('origin-idea-id').value = ""; 

  document.getElementById('todo-form').reset();
  
  // [ì¶”ê°€] ğŸš€ ì˜¤ëŠ˜ ë‚ ì§œ ìë™ ì…ë ¥ (ë¡œì»¬ ì‹œê°„ ê¸°ì¤€)
  const today = new Date();
  const localIso = new Date(today.getTime() - (today.getTimezoneOffset() * 60000)).toISOString().split('T')[0];
  
  document.getElementById('input-due').value = localIso;  // ë§ˆê°ì¼/ë“±ë¡ì¼
  document.getElementById('input-start').value = localIso; // ì‹œì‘ì¼(ëª©í‘œì¼ ê²½ìš°)

  $('#input-detail').summernote('reset'); 
  toggleEditMode(true);
  
  if(type) {
      const radio = document.querySelector(`input[name="type"][value="${type}"]`);
      if(radio) {
          radio.click(); // click()ì„ í•´ì•¼ toggleFormFields()ê°€ íŠ¸ë¦¬ê±°ë¨
      }
  }
}

// [ìˆ˜ì •] í¼ í•„ë“œ í† ê¸€ ë¡œì§ (ì•„ì´ë””ì–´ ì¹´í…Œê³ ë¦¬ ì²˜ë¦¬ ì¶”ê°€)
function toggleFormFields() {
  const type = document.querySelector('input[name="type"]:checked').value;
  const isGoal = type.includes("ëª©í‘œ");
  const isIdea = type === "ì•„ì´ë””ì–´";

  // ë‚ ì§œ/ìš°ì„ ìˆœìœ„ í•„ë“œ ì œì–´
  if (isGoal) { 
    document.getElementById('field-start-date').style.display = "block"; 
    document.getElementById('field-due-date').style.display = "block"; 
    document.getElementById('field-priority').style.display = "none"; 
  } else { 
    document.getElementById('field-start-date').style.display = "none"; 
    document.getElementById('field-due-date').style.display = "block"; 
    document.getElementById('field-priority').style.display = "block"; 
  }
  
  // ë²„ê·¸ ìë™ ìš°ì„ ìˆœìœ„
  if (type === 'ë²„ê·¸') document.getElementById('input-priority').value = 'ë†’ìŒ';

  // ìƒ‰ìƒ(ì¹´í…Œê³ ë¦¬) í•„ë“œ ì œì–´
  const fieldColor = document.getElementById('field-color');
  const labelColor = document.getElementById('label-color-theme');
  const pickerGoal = document.getElementById('color-picker-goal');
  const pickerIdea = document.getElementById('color-picker-idea');

  if (type === "í° ëª©í‘œ") {
    fieldColor.style.display = "block";
    labelColor.textContent = "í…Œë§ˆ ìƒ‰ìƒ";
    pickerGoal.style.display = "flex";
    pickerIdea.style.display = "none";
  } else if (isIdea) {
    fieldColor.style.display = "block";
    labelColor.textContent = "ì•„ì´ë””ì–´ ë¶„ë¥˜";
    pickerGoal.style.display = "none";
    pickerIdea.style.display = "flex";
  } else {
    fieldColor.style.display = "none";
  }
  
  updateParentOptions(type);
}

  function updateParentOptions(type) {
    const select = document.getElementById('input-connected-id'); select.innerHTML = '<option value="">(ì„ íƒ ì—†ìŒ)</option>';
    let opts = [];
    if(!type || type==='í• ì¼' || type==='ì•„ì´ë””ì–´') opts = g_goals.filter(g => g['ìœ í˜•'] === 'ì¤‘ê°„ ëª©í‘œ');
    else if(type==='ì¤‘ê°„ ëª©í‘œ') opts = g_goals.filter(g => g['ìœ í˜•'] === 'í° ëª©í‘œ');
    opts.forEach(o => { const op = document.createElement('option'); op.value = o.ID; op.textContent = o['ì œëª©']; select.appendChild(op); });
  }

  function openEditModal(typeHint, id) {
    let item = g_goals.find(x => x.ID === id) || g_tasks.find(x => x.ID === id);
    if (!item) return;
    document.getElementById('input-modal').classList.add('open');
    document.getElementById('todo-modal-title').textContent = "í•­ëª© ìƒì„¸";
    document.getElementById('edit-mode').value = "true";
    document.getElementById('edit-id').value = id;
    document.getElementById('origin-idea-id').value = ""; 

    document.getElementById('input-title').value = item['ì œëª©'];
    const safeContent = item['ìƒì„¸ë‚´ìš©'] || "";
    $('#input-detail').summernote('code', safeContent);

    if (item['ìƒ‰ìƒ']) { const radio = document.querySelector(`input[name="color"][value="${item['ìƒ‰ìƒ']}"]`); if(radio) radio.checked = true; }
    const typeRadios = document.querySelectorAll('input[name="type"]');
    typeRadios.forEach(r => { if(r.value === item['ìœ í˜•']) r.checked = true; });
    toggleFormFields();

    if (item['ìœ í˜•'].includes("ëª©í‘œ")) {
        document.getElementById('input-start').value = (item['ì‹œì‘ì¼']||"").split('T')[0];
        document.getElementById('input-due').value = (item['ë§ˆê°ì¼']||"").split('T')[0];
        if(item['ìœ í˜•'] === 'ì¤‘ê°„ ëª©í‘œ') document.getElementById('input-connected-id').value = item['ìƒìœ„ID'];
    } else {
        document.getElementById('input-connected-id').value = item['ì—°ê²°_ì¤‘ê°„ëª©í‘œID'];
        document.getElementById('input-due').value = (item['ê¸°í•œ']||"").split('T')[0];
        document.getElementById('input-priority').value = item['ìš°ì„ ìˆœìœ„'] || "ë³´í†µ";
    }
    
    // [ì¤‘ìš” ìˆ˜ì •] ê¸°ì¡´ì—ëŠ” toggleEditMode(false)ë¡œ í˜¸ì¶œí•˜ì—¬ ë¹„í™œì„±í™”/ì‚­ì œë²„íŠ¼ ìˆ¨ê¹€ ìƒíƒœì˜€ìŒ.
    // ë°”ë¡œ ìˆ˜ì • ë° ì‚­ì œê°€ ê°€ëŠ¥í•˜ë„ë¡ trueë¡œ í˜¸ì¶œí•©ë‹ˆë‹¤.
    toggleEditMode(true);
    
    const delBtn = document.getElementById('btn-delete-modal'); 
    if(delBtn) {
        delBtn.style.display = "block"; 
        delBtn.onclick = () => deleteFromModal();
    }

    renderHistoryInModal(id);
    renderRelatedIdeasInModal(id);
  }

// ğŸš€ [ìˆ˜ì •] íˆìŠ¤í† ë¦¬ ë Œë”ë§ (ë‚ ì§œ ë°€ë¦¼ í•´ê²° + ì ‘ê¸°/í¼ì¹˜ê¸°)
  function renderHistoryInModal(targetId) {
    const container = document.getElementById('related-history-section');
    const listRoot = document.getElementById('history-list-root');
    const relatedLogs = g_logs.filter(l => String(l['ê´€ë ¨_ëª©í‘œID']) === String(targetId));

    if (relatedLogs.length === 0) { container.style.display = 'none'; return; }

    relatedLogs.sort((a, b) => new Date(b['ë‚ ì§œ'].substring(0,10).replace(/-/g,'/')) - new Date(a['ë‚ ì§œ'].substring(0,10).replace(/-/g,'/')));

    container.style.display = 'block'; listRoot.innerHTML = "";

    relatedLogs.forEach(log => {
        const item = document.createElement('div');
        item.className = 'history-item';
        item.onclick = function() { this.classList.toggle('expanded'); };
        
        let dateStr = '';
        if (log['ë‚ ì§œ']) {
            const rawDate = log['ë‚ ì§œ'].substring(0, 10).replace(/-/g, '/');
            const d = new Date(rawDate);
            const year = d.getFullYear();
            const month = String(d.getMonth() + 1).padStart(2, '0');
            const day = String(d.getDate()).padStart(2, '0');
            dateStr = `${year}-${month}-${day}`;
        }
        
        const timeStr = log['ì†Œìš”ì‹œê°„'] ? `â± ${log['ì†Œìš”ì‹œê°„']}` : '';
        const content = (log['ë‚´ìš©'] || "").replace(/\n/g, '<br>');

        item.innerHTML = `
            <div class="history-header">
                <span class="history-date">ğŸ“… ${dateStr}</span>
                <span class="history-time">${timeStr}</span>
            </div>
            <div class="history-content">${content}</div>
        `;
        listRoot.appendChild(item);
    });
  }
  
  function renderRelatedIdeasInModal(targetId) {
    const container = document.getElementById('related-idea-section');
    const root = document.getElementById('related-idea-root');
    const relatedIdeas = g_tasks.filter(t => t['ìœ í˜•'] === 'ì•„ì´ë””ì–´' && t['ì—°ê²°_ì¤‘ê°„ëª©í‘œID'] === targetId);

    if (relatedIdeas.length > 0) {
      container.style.display = 'block';
      root.innerHTML = relatedIdeas.map(idea => `
        <div class="mini-idea-card" onclick="openEditModal('idea', '${idea.ID}')">
          <div class="mini-idea-title">ğŸ’¡ ${idea['ì œëª©']}</div>
          <div class="mini-idea-desc">${(idea['ìƒì„¸ë‚´ìš©'] || '').replace(/<[^>]*>?/gm, '')}</div>
        </div>
      `).join('');
    } else {
      container.style.display = 'none';
    }
  }

  function createNewLogFromTask() {
    const taskId = document.getElementById('edit-id').value;
    const taskTitle = document.getElementById('input-title').value;
    if (!taskId) return;
    closeModal('input-modal');
    openLogModal(); 
    const relatedSelect = document.getElementById('log-related-id');
    if (relatedSelect) relatedSelect.value = taskId;
    document.getElementById('log-title').value = taskTitle + " ì‘ì—… ê¸°ë¡";
  }

  function openEditLog(id) {
    const log = g_logs.find(x => x.ID === id); if (!log) return;
    document.getElementById('log-modal').classList.add('open'); document.getElementById('log-modal-title').textContent = "ê¸°ë¡ ìˆ˜ì •"; document.getElementById('log-edit-mode').value = "true"; document.getElementById('log-edit-id').value = id;
    
    // [ìˆ˜ì •] ìˆ˜ì • ëª¨ë“œì—ì„œë„ ë‚ ì§œ íŒŒì‹± ì˜¤ë¥˜ ë°©ì§€
    const d = new Date(log['ë‚ ì§œ']);
    let localIso = "";
    if(!isNaN(d.getTime())) {
        const year = d.getFullYear();
        const month = String(d.getMonth() + 1).padStart(2, '0');
        const day = String(d.getDate()).padStart(2, '0');
        localIso = `${year}-${month}-${day}`;
    } else {
        localIso = (log['ë‚ ì§œ']||"").split('T')[0];
    }
    document.getElementById('log-date').value = localIso;

    document.getElementById('log-title').value = log['ì œëª©'] || ""; document.getElementById('log-content').value = log['ë‚´ìš©'] || ""; document.getElementById('log-duration').value = log['ì†Œìš”ì‹œê°„'] || ""; document.getElementById('log-tags').value = log['íƒœê·¸'] || ""; document.getElementById('log-idea-section').style.display = 'none';
    updateLogTaskOptions(log['ê´€ë ¨_ëª©í‘œID']);
  }

  function deleteFromModal() { const id = document.getElementById('edit-id').value; deleteItem(id); closeModal('input-modal'); }
// ğŸš€ [ìˆ˜ì •] ìƒíƒœ ë³€ê²½ + ì™„ë£Œ ì‹œ ìë™ ë¡œê·¸
  async function toggleStatus(id, newStatus) {
    // 1. ìƒíƒœ ì—…ë°ì´íŠ¸ ìš”ì²­
    await fetch(window.CHEESE_ADMIN_API_BASE, { 
        method: "POST", 
        body: JSON.stringify({ mode: "updateStatus", id: id, status: newStatus }) 
    });

    // 2. 'ì™„ë£Œ' ìƒíƒœê°€ ë˜ë©´ ìë™ìœ¼ë¡œ ë¡œê·¸ ë‚¨ê¸°ê¸°
    if (newStatus === 'ì™„ë£Œ') {
        const item = g_goals.find(x => x.ID === id) || g_tasks.find(x => x.ID === id);
        if (item) {
            // ì‚¬ìš©ìì—ê²Œ ë°©í•´ë˜ì§€ ì•Šê²Œ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰
            await createAutoLog("complete", item['ì œëª©'], id);
        }
    }

    // 3. í™”ë©´ ê°±ì‹ 
    loadAllData(); 
  }  async function deleteItem(id) { if(!confirm("ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return; if(typeof showAdminLoading==='function') showAdminLoading("ì‚­ì œ ì¤‘..."); await fetch(window.CHEESE_ADMIN_API_BASE, { method: "POST", body: JSON.stringify({ mode: "deleteItem", id: id }) }); loadAllData(); if(typeof hideAdminLoading==='function') hideAdminLoading(); }

  document.getElementById('todo-form').addEventListener('submit', async (e) => {
    e.preventDefault();
    // [ì¶”ê°€] ì €ì¥ ë²„íŠ¼ ì°¾ê¸° (ì¤‘ìš”: ì„ íƒì ìˆ˜ì •)
    // ê¸°ì¡´ '#edit-actions button'ì€ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì˜¬ë°”ë¥¸ í´ë˜ìŠ¤ ì„ íƒì ì‚¬ìš©
    const saveBtn = document.querySelector('.btn-save-custom');
    
    // [ì¶”ê°€] ë¡œë”© ì‹œì‘ (ë²„íŠ¼ ë¹„í™œì„±í™”)
    toggleBtnLoading(saveBtn, true);
    
    const isEdit = document.getElementById('edit-mode').value === "true";
    const type = document.querySelector('input[name="type"]:checked').value;
    const color = document.querySelector('input[name="color"]:checked').value;
    const detailContent = $('#input-detail').summernote('code');
    const originIdeaId = document.getElementById('origin-idea-id').value;

    const payload = { 
        mode: isEdit ? "editItem" : "addItem", id: document.getElementById('edit-id').value, type: type, 
        title: document.getElementById('input-title').value, parentId: document.getElementById('input-connected-id').value, 
        connectedId: document.getElementById('input-connected-id').value, 
        detail: detailContent, 
        startDate: document.getElementById('input-start').value, dueDate: document.getElementById('input-due').value, 
        priority: document.getElementById('input-priority').value, color: color 
    };
    
    if(typeof showAdminLoading==='function') showAdminLoading("ì €ì¥ ì¤‘..."); 
    
    try {
        const response = await fetch(window.CHEESE_ADMIN_API_BASE, { method: "POST", body: JSON.stringify(payload) });
        const result = await response.json();

        // ğŸš€ [ìˆ˜ì •] ì•„ì´ë””ì–´ ì‹¤í˜„ ì—°ê²° ë¡œì§ + ìë™ ë¡œê·¸ ì¶”ê°€
        if (!isEdit && result.id && originIdeaId) {
            // 1. ê¸°ì¡´ ì•„ì´ë””ì–´ì™€ ìƒˆ ì‘ì—… ì—°ê²° (ì„œë²„ ìš”ì²­)
            await fetch(window.CHEESE_ADMIN_API_BASE, { method: "POST", body: JSON.stringify({ mode: "editItem", id: originIdeaId, connectedId: result.id }) });
            
            // 2. [NEW] ì‹¤í˜„ ë¡œê·¸ ìë™ ìƒì„±! (ì—¬ê¸°ì— ì¶”ê°€í•˜ì„¸ìš”)
            const taskTitle = document.getElementById('input-title').value;
            await createAutoLog("realize_idea", taskTitle, result.id);
        }
        // ğŸš€ [ì¶”ê°€] ì—¬ê¸°ê°€ í•µì‹¬! ì‹ ê·œ ë“±ë¡ ì‹œ ìë™ ë¡œê·¸ ìƒì„± ë¡œì§
        if (!isEdit && result.result === "success") {
            const newId = result.id; // ì„œë²„ì—ì„œ ë°œê¸‰ë°›ì€ ìƒˆ ID
            const title = document.getElementById('input-title').value;
            
            if (type === "ë²„ê·¸") {
                await createAutoLog("create_bug", title, newId);
            } else if (type === "ì•„ì´ë””ì–´") {
                await createAutoLog("create_idea", title, newId);
            } else if (type.includes("ëª©í‘œ")) { // í° ëª©í‘œ, ì¤‘ê°„ ëª©í‘œ
                await createAutoLog("create_goal", title, newId);
            }
        }
        closeModal('input-modal'); loadAllData();
    } catch(err) { console.error(err); alert("ì €ì¥ ì¤‘ ì˜¤ë¥˜ ë°œìƒ"); } 
    finally { if(typeof hideAdminLoading==='function') hideAdminLoading(); toggleBtnLoading(saveBtn, false);}
  });

// ğŸš€ [ìˆ˜ì •] ë¡œê·¸ ì €ì¥ ë¡œì§ (ëª©í‘œ ì—°ê²° í—ˆìš©, ì‘ì—… ì—°ê²° ì‹œ ìë™ì‹¤í˜„ ë°©ì§€)
  document.getElementById('log-form').addEventListener('submit', async (e) => {
    e.preventDefault();
    // [ì¶”ê°€] ì €ì¥ ë²„íŠ¼ ì°¾ê¸°
    const saveBtn = document.querySelector('#log-form button[type="submit"]');
    
    // [ì¶”ê°€] ë¡œë”© ì‹œì‘
    toggleBtnLoading(saveBtn, true);
    const isEdit = document.getElementById('log-edit-mode').value === "true";
    const relatedId = document.getElementById('log-related-id').value; 
    
    const dateVal = document.getElementById('log-date').value;
    const titleVal = document.getElementById('log-title').value;
    let contentVal = document.getElementById('log-content').value;
    const durationVal = document.getElementById('log-duration').value;
    const tagsVal = document.getElementById('log-tags').value;
    
    const bugInput = document.getElementById('log-bug-input');
    const bugTitle = bugInput ? bugInput.value.trim() : "";
    const bugDetailVal = document.getElementById('log-bug-detail') ? document.getElementById('log-bug-detail').value.trim() : "";

    const ideaInput = document.getElementById('log-idea-input');
    const ideaTitle = ideaInput ? ideaInput.value.trim() : "";

    if(typeof showAdminLoading === 'function') showAdminLoading("ì €ì¥ ì¤‘..."); 

    try {
      const requests = [];

      // 1. ë²„ê·¸ ë“±ë¡
      if (!isEdit && bugTitle !== "") {
         contentVal += `\n\n[System] ğŸ ë²„ê·¸ ë¦¬í¬íŠ¸ ìƒì„±ë¨: ${bugTitle}`;
         const bugFullDetail = `${bugDetailVal}\n\n---\nğŸ“Œ ë°œê²¬ëœ ì‘ì—… ë¡œê·¸: ${titleVal || 'ì œëª© ì—†ëŠ” ë¡œê·¸'} (${dateVal})`;
         requests.push(fetch(window.CHEESE_ADMIN_API_BASE, { 
           method: "POST", body: JSON.stringify({ mode: "addItem", type: "ë²„ê·¸", title: bugTitle, detail: bugFullDetail, priority: "ë†’ìŒ", connectedId: relatedId }) 
         }));
      }

      // 2. ì•„ì´ë””ì–´ ë“±ë¡ (ëª©í‘œëŠ” ì—°ê²°í•˜ê³ , ì‘ì—…ì€ ì—°ê²° ì•ˆ í•¨)
      if (!isEdit && ideaTitle !== "") {
        let connectionForIdea = "";
        // IDê°€ G_ ë˜ëŠ” M_ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ê²½ìš°ì—ë§Œ ì—°ê²° (ì‘ì—…/ë²„ê·¸ì™€ ì—°ê²°ë˜ë©´ ì‹¤í˜„ë¨ìœ¼ë¡œ ì²˜ë¦¬ë˜ë¯€ë¡œ ë°©ì§€)
        if (relatedId && (relatedId.startsWith('G_') || relatedId.startsWith('M_'))) {
            connectionForIdea = relatedId;
        }
        requests.push(fetch(window.CHEESE_ADMIN_API_BASE, { 
          method: "POST", body: JSON.stringify({ mode: "addItem", type: "ì•„ì´ë””ì–´", title: ideaTitle, detail: "ì‘ì—… ë¡œê·¸ ì‘ì„± ì¤‘ íŒŒìƒë¨: " + titleVal, priority: "ë³´í†µ", connectedId: connectionForIdea }) 
        }));
      }

      // 3. ë¡œê·¸ ì €ì¥
      const logPayload = { 
        mode: isEdit ? "editItem" : "addLog", id: document.getElementById('log-edit-id').value, 
        date: dateVal, title: titleVal, content: contentVal, duration: durationVal, tags: tagsVal, relatedId: relatedId
      };
      requests.push(fetch(window.CHEESE_ADMIN_API_BASE, { method: "POST", body: JSON.stringify(logPayload) }));

      await Promise.all(requests); 
      closeModal('log-modal'); loadAllData(); 

    } catch (err) { console.error("ì €ì¥ ì‹¤íŒ¨:", err); alert("ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."); } 
    finally { if(typeof hideAdminLoading === 'function') hideAdminLoading(); toggleBtnLoading(saveBtn, false);}
  });

// ğŸš€ [ìˆ˜ì •] ìë™ ë¡œê·¸ ìƒì„± í•¨ìˆ˜ (ì¼€ì´ìŠ¤ ì¶”ê°€)
  async function createAutoLog(actionType, itemTitle, itemId) {
    const today = new Date().toISOString().split('T')[0];
    let logTitle = "";
    let logContent = "";
    let tags = "System";

    if (actionType === "create_bug") {
        logTitle = "ğŸš¨ ë²„ê·¸ ë¦¬í¬íŠ¸ ë“±ë¡";
        logContent = `ìƒˆë¡œìš´ ë²„ê·¸ê°€ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.\nì œëª©: ${itemTitle}`;
        tags = "BugReport";
    } else if (actionType === "create_idea") {
        logTitle = "ğŸ’¡ ìƒˆ ì•„ì´ë””ì–´";
        logContent = `ìƒˆë¡œìš´ ì•„ì´ë””ì–´ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.\nì œëª©: ${itemTitle}`;
        tags = "Idea";
    } else if (actionType === "create_goal") {
        logTitle = "ğŸš© ëª©í‘œ ì„¤ì •";
        logContent = `ìƒˆë¡œìš´ ëª©í‘œê°€ ìˆ˜ë¦½ë˜ì—ˆìŠµë‹ˆë‹¤.\nëª©í‘œëª…: ${itemTitle}`;
        tags = "Goal";
    } else if (actionType === "complete") {
        logTitle = "âœ… ë‹¬ì„±/ì™„ë£Œ";
        logContent = `ì‘ì—…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!\nì‘ì—…ëª…: ${itemTitle}`;
        tags = "Done";
    } 
    // ğŸ‘‡ [ì—¬ê¸°] ì•„ì´ë””ì–´ ì‹¤í˜„ ì¼€ì´ìŠ¤ ì¶”ê°€!
    else if (actionType === "realize_idea") {
        logTitle = "ğŸš€ ì•„ì´ë””ì–´ ì‹¤í˜„!";
        logContent = `ì•„ì´ë””ì–´ê°€ êµ¬ì²´ì ì¸ ì‘ì—…ìœ¼ë¡œ ë³€í™˜ë˜ì—ˆìŠµë‹ˆë‹¤.\nì‘ì—…ëª…: ${itemTitle}`;
        tags = "Realization";
    }

    try {
        await fetch(window.CHEESE_ADMIN_API_BASE, {
            method: "POST",
            body: JSON.stringify({
                mode: "addLog",
                date: today,
                title: logTitle,
                content: logContent,
                relatedId: itemId || "",
                tags: tags
            })
        });
    } catch(e) {
        console.error("ìë™ ë¡œê·¸ ìƒì„± ì‹¤íŒ¨:", e);
    }
  }
  // ==================================================
  // [ì¶”ê°€] ìë™ ë²„ì „ ê´€ë¦¬ í‘œì‹œ í•¨ìˆ˜ (document.lastModified í™œìš©)
  // ==================================================
    (function showVersion() {
      const el = document.getElementById("sysVersion");
      if (!el) return;
      
      // íŒŒì¼ì˜ ë§ˆì§€ë§‰ ìˆ˜ì • ë‚ ì§œ(Last Modified)ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
      const d = new Date(document.lastModified);
      
      // ë‚ ì§œ í¬ë§·íŒ… í—¬í¼
      const pad = (n) => String(n).padStart(2, '0');
      
      // í¬ë§·: YYYY.MM.DD_HH:MM [ìˆ˜ì •]
      const versionTag = `${d.getFullYear()}.${pad(d.getMonth()+1)}.${pad(d.getDate())}_${pad(d.getHours())}:${pad(d.getMinutes())} [ìˆ˜ì •]`;
      
      el.textContent = `Version: ${versionTag}`;
    })();
</script>
</body>
</html>
