<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Daily Log Export</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- 관리자 공통 CSS (이미 쓰고 있다면 유지) -->
  <link rel="stylesheet" href="./admin.css">
</head>

<body>
  <div class="admin-shell">
    <!-- 헤더 슬롯 -->
    <div id="admin-header-slot"></div>

    <div class="admin-main">
      <!-- 메뉴 슬롯 -->
      <aside id="admin-menu-slot" class="admin-sidebar"></aside>

      <!-- 메인 콘텐츠 -->
      <main class="wrap">

        <h1>Daily Log Export</h1>
        <p class="desc">
          daily_events 시트 데이터를 블로그에 바로 붙여넣을 수 있는 HTML로 변환합니다.
        </p>

        <div class="form-row">
          <label>연도</label>
          <input id="year" type="number" value="2026" style="width:100px">

          <label style="margin-left:12px">월</label>
          <input id="month" type="number" value="1" style="width:80px">

          <button onclick="generate()" class="btn primary" style="margin-left:12px">
            HTML 생성
          </button>
        </div>

        <textarea
          id="output"
          placeholder="여기에 daily-log HTML이 생성됩니다"
          style="width:100%; height:360px; margin-top:16px;"
        ></textarea>

      </main>
    </div>
  </div>

  <!-- 반드시 포함해야 하는 공통 스크립트 -->
  <script src="./admin-common.js"></script>

  <!-- 이 화면 전용 스크립트 -->
  <script>
    function generate() {
      const year  = Number(document.getElementById("year").value);
      const month = Number(document.getElementById("month").value);

      google.script.run
        .withSuccessHandler(html => {
          document.getElementById("output").value = html;
        })
        .exportDailyLog(year, month);
    }
  </script>
</body>
</html>
