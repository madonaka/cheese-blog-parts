<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Daily Log Export</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- 관리자 공통 CSS -->
  <link rel="stylesheet" href="./admin.css">
</head>

<body>
  <div class="admin-shell">
    <div id="admin-header-slot"></div>

    <div class="admin-main">
      <aside id="admin-menu-slot" class="admin-sidebar"></aside>

      <main class="wrap">
        <h1>Daily Log Export</h1>
        <p class="desc">
          daily_events 시트 데이터를 블로그에 바로 붙여넣을 수 있는 HTML로 변환합니다.
        </p>

        <div class="form-row">
          <label>연도</label>
          <input id="year" type="number" value="2026" style="width:100px">

          <label style="margin-left:12px">월</label>
          <input id="month" type="number" value="1" style="width:80px">

          <button onclick="generate()" class="btn primary" style="margin-left:12px">
            HTML 생성
          </button>
        </div>

        <textarea
          id="output"
          placeholder="여기에 daily-log HTML이 생성됩니다"
          style="width:100%; height:360px; margin-top:16px;"
        ></textarea>
      </main>
    </div>
  </div>

  <!-- 관리자 공통 스크립트 -->
  <script src="./admin-common.js"></script>

  <!-- 이 화면 전용 스크립트 -->
  <script>
    const API_BASE =
      "https://script.google.com/macros/s/AKfycbyuC0qHyRdDKL2fC5fmRy66l0y1baCLbXuf9pNlPh0rBde_HQMzaqQv5NK06H_n7WFk/exec";

    async function generate() {
      const year  = document.getElementById("year").value;
      const month = document.getElementById("month").value;

      const url = `${API_BASE}?mode=exportDailyLog&year=${year}&month=${month}`;

      try {
        const res = await fetch(url);
        if (!res.ok) throw new Error("API 호출 실패");

        const html = await res.text();
        document.getElementById("output").value = html;

      } catch (e) {
        alert("HTML 생성 실패: " + e.message);
      }
    }
  </script>
</body>
</html>
