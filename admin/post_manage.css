<style>
  /* [1. 레이아웃 & 공통] */
  .pm-wrap { padding: 14px; padding-bottom: 90px; } 
  .pm-hr { height: 1px; background: rgba(15,23,42,0.10); margin: 12px 0; }
  .pm-hidden { display: none !important; }
  .pm-card { background: #fff; border: 1px solid rgba(15,23,42,0.14); border-radius: 14px; padding: 14px; margin-bottom: 12px; box-shadow: 0 10px 24px rgba(15,23,42,0.06); }
  .pm-row { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }
  .pm-label { font-weight: 800; }
  .pm-muted { color: #6b7280; font-size: 13px; }
  .pm-small { font-size: 12px; color: #6b7280; }
  .pm-status { margin-top: 10px; font-size: 13px; }
  .pm-status.ok { color: #047857; }
  .pm-status.err { color: #b91c1c; }
  .pm-link { color: #2563eb; font-weight: 800; text-decoration: none; padding: 6px 0; white-space: normal; word-break: break-all; overflow-wrap: anywhere; }
  .pm-pill { display: inline-block; padding: 3px 8px; border-radius: 999px; border: 1px solid rgba(15,23,42,0.15); font-size: 12px; margin-left: 8px; }
  .pm-banner { margin: 0 0 12px; padding: 10px 12px; border-radius: 12px; border: 1px solid rgba(185,28,28,0.25); background: rgba(185,28,28,0.06); color: #7f1d1d; font-weight: 800; font-size: 13px; display: none; white-space: pre-line; }
  .pm-meta { display: grid; grid-template-columns: 140px 1fr; gap: 8px 12px; margin-top: 10px; }
  .pm-meta > div { padding: 6px 0; min-width: 0 !important; white-space: normal !important; word-break: break-all !important; overflow-wrap: anywhere !important; }
  #debug { margin: 10px 0 0; padding: 10px; border: 1px solid rgba(15,23,42,0.14); border-radius: 12px; background: rgba(15,23,42,0.03); overflow: auto; max-height: 220px; font-size: 12px; white-space: pre-wrap !important; word-break: break-all !important; overflow-wrap: anywhere !important; max-width: 100%; }

  /* [2. 입력 폼 & 버튼] */
  .pm-input, .pm-select { padding: 10px 12px; border: 1px solid rgba(15,23,42,0.2); border-radius: 10px; min-width: 280px; background: #fff; }
  .pm-title { min-width: 420px; }
  .pm-textarea { width: 100%; min-height: 420px; padding: 12px; border: 1px solid rgba(15,23,42,0.2); border-radius: 12px; font-family: ui-monospace, monospace; font-size: 13px; line-height: 1.45; }
  .pm-btn { padding: 10px 12px; border-radius: 10px; border: 1px solid rgba(15,23,42,0.18); background: #fff; cursor: pointer; font-weight: 800; white-space: nowrap; }
  .pm-btn.primary { background: #111827; color: #fff; border-color: #111827; }
  .pm-btn.danger { background: #b91c1c; color: #fff; border-color: #b91c1c; }
  .pm-btn.ghost { background: rgba(15,23,42,0.03); }
  .pm-btn.small { padding: 8px 10px; font-size: 12px; border-radius: 9px; }

  /* [3. 동적 필드 & 이미지 박스] */
  .pm-dyn-grid { display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 10px 12px; align-items: stretch; }
  .pm-dyn-item { border: 1px solid rgba(15,23,42,0.12); border-radius: 12px; padding: 10px; background: rgba(15,23,42,0.02); }
  .pm-dyn-head { display: flex; align-items: center; justify-content: space-between; gap: 8px; margin: 0 0 6px; }
  .pm-dyn-key { font-weight: 900; margin: 0; }
  .pm-dyn-clear { padding: 6px 10px; font-size: 12px; border-radius: 9px; }
  .pm-dyn-help { margin: 0 0 10px; }
  .pm-dyn-textarea { min-height: 200px; }
  .pm-img-box > div:first-child { width: 160px !important; height: 120px !important; flex-shrink: 0; border: 1px solid #cbd5e1; }

  /* [4. 상단 스티키 바] */
  .pm-stickybar { position: sticky; top: 0; z-index: 50; margin: 0 0 12px; padding: 12px; border-radius: 14px; border: 1px solid rgba(15,23,42,0.14); background: rgba(255,255,255,0.92); backdrop-filter: blur(10px); box-shadow: 0 10px 24px rgba(15,23,42,0.08); }
  .pm-stickybar .bar-row { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }
  .pm-stickybar .bar-left { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; }
  .pm-stickybar .bar-right { margin-left: auto; display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }
  .pm-sticky-id { font-weight: 900; padding: 6px 10px; border-radius: 999px; background: rgba(15,23,42,0.04); border: 1px solid rgba(15,23,42,0.12); max-width: 340px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
  .pm-sticky-status { display: flex; align-items: center; gap: 8px; padding: 6px 10px; border-radius: 999px; border: 1px solid rgba(15,23,42,0.12); background: rgba(15,23,42,0.03); font-size: 12px; color: #111827; max-width: 520px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
  .pm-sticky-status.ok { color: #047857; border-color: rgba(4,120,87,0.25); background: rgba(4,120,87,0.06); }
  .pm-sticky-status.err { color: #b91c1c; border-color: rgba(185,28,28,0.25); background: rgba(185,28,28,0.06); }
  .pm-spinner { width: 14px; height: 14px; border-radius: 50%; border: 2px solid rgba(15,23,42,0.22); border-top-color: rgba(15,23,42,0.75); animation: pmspin 0.9s linear infinite; display: none; flex: 0 0 auto; }
  .pm-spinner.on { display: inline-block; }
  @keyframes pmspin { to { transform: rotate(360deg); } }
  .pm-sticky-actions { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; }
  .pm-divider { width: 1px; height: 26px; background: rgba(15,23,42,0.12); margin: 0 2px; }
  .pm-top-grid { display: grid; grid-template-columns: 3fr 1fr; gap: 12px; align-items: start; }

  /* [5. 섹션 정렬 & 라이브러리] */
  .pm-sort-list { list-style: none; padding: 0; margin: 0; max-height: 400px; overflow-y: auto; }
  .pm-sort-item { display: flex; align-items: center; gap: 8px; padding: 8px 10px; background: #fff; border: 1px solid rgba(15,23,42,0.15); border-radius: 8px; margin-bottom: 6px; cursor: grab; transition: background 0.2s, transform 0.2s; font-size: 13px; user-select: none; }
  .pm-sort-item:active { cursor: grabbing; background: #f1f5f9; }
  .pm-sort-item.dragging { opacity: 0.5; background: #e2e8f0; border-style: dashed; }
  .pm-sort-idx { font-weight: 900; color: #2563eb; width: 20px; text-align: center; }
  .pm-sort-name { flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; font-weight: 600; min-width: 0; }
  .pm-lib-list { list-style: none; padding: 0; margin: 0; }
  .pm-lib-item { padding: 10px 12px; border-bottom: 1px solid #f1f5f9; cursor: pointer; display: flex; justify-content: space-between; align-items: center; transition: background 0.15s; border-radius: 8px; }
  .pm-lib-item:hover { background: #eff6ff; }
  .pm-lib-item:last-child { border-bottom: none; }
  .pm-lib-name { font-weight: 600; font-size: 14px; color: #334155; }
  .pm-lib-add { color: #2563eb; font-size: 12px; font-weight: 800; }

  /* [6. 모달 & 상태 표시] */
  .pm-modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); backdrop-filter: blur(4px); z-index: 9999; display: flex; align-items: center; justify-content: center; }
  .pm-modal-content { background: #fff; width: 90%; max-width: 500px; max-height: 80vh; border-radius: 16px; box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1); display: flex; flex-direction: column; overflow: hidden; animation: pmFadeIn 0.2s ease-out; }
  .pm-modal-header { padding: 16px 20px; border-bottom: 1px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center; background: #f8fafc; }
  .pm-modal-body { padding: 16px 20px; overflow-y: auto; flex: 1; }
  .pm-modal-footer { padding: 12px 20px; border-top: 1px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center; background: #f8fafc; }
  @keyframes pmFadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
  .status-dot { display: inline-block; width: 10px; height: 10px; border-radius: 50%; margin-right: 8px; vertical-align: middle; flex-shrink: 0; transition: all 0.3s ease; }
  #stickyId .status-dot { margin-top: -2px; }
  .status-published { background-color: #22c55e; box-shadow: 0 0 6px #22c55e; }
  .status-draft { background-color: #ef4444; box-shadow: 0 0 6px #ef4444; }
  .status-unknown { background-color: #94a3b8; }

  /* [7. 반응형 & 모바일 최적화] */
  /*  (PC 기본 설정) */
  .pm-mobile-toggle { display: none !important; }
  .pm-foldable-area { display: block !important; }
  .primary-actions, .secondary-actions { display: flex; gap: 8px; align-items: center; }
  .mobile-hr { display: none; }
  .desktop-only { display: block; }  
  @media (max-width: 1100px) { .pm-top-grid { grid-template-columns: 1fr; } }
  @media (max-width: 980px) { .pm-dyn-grid { grid-template-columns: 1fr; } }
  @media (max-width: 768px) {
    .pm-wrap { padding: 10px; padding-bottom: 90px; }
    .pm-modal-content { width: 95% !important; max-height: 85vh; }
    .pm-input, .pm-select, .pm-title { min-width: 0 !important; width: 100% !important; box-sizing: border-box; }
    .pm-top-grid > .pm-card { min-width: 0 !important; width: 100% !important; }
    .pm-sort-item { width: 100%; box-sizing: border-box; max-width: 100%; }
    .pm-stickybar .bar-row, .pm-stickybar .bar-left, .pm-stickybar .bar-right { width: 100%; justify-content: flex-start; }
    .pm-stickybar input[type="text"] { width: 100% !important; min-width: 0 !important; }
    .pm-row .pm-btn { flex: 1; text-align: center; justify-content: center; }
    .pm-sticky-actions { display: grid !important; grid-template-columns: 1fr 1fr; gap: 8px !important; width: 100%; margin-top: 10px; }
    .pm-sticky-actions .pm-btn { width: 100% !important; margin: 0 !important; display: flex; align-items: center; justify-content: center; height: 42px; }
    .pm-sticky-actions .pm-divider { display: none !important; }
    #btnClear { grid-column: 1 / -1; background-color: #fef2f2; border-color: #fee2e2; color: #ef4444; }
    .pm-img-box { flex-direction: column !important; }
    .pm-img-box > div:first-child { width: 100% !important; height: 180px !important; margin-bottom: 10px; }
    .pm-img-box .pm-muted { white-space: normal !important; font-size: 11px; line-height: 1.3; }
    .pm-img-box button { flex: 1; }
    .pm-mobile-toggle { 
      display: block !important; 
      width: 100% !important; 
      margin-top: 12px; 
      padding: 10px; 
      background-color: #f1f5f9; 
      border: 1px solid #e2e8f0; 
      color: #475569;
      font-size: 13px;
      font-weight: bold;
    }    .pm-foldable-area { display: none !important; margin-top: 8px; padding-top: 8px; }
    .pm-foldable-area.show { display: block !important; animation: pmSlideDown 0.2s ease-out; }
    .desktop-only { display: none !important; }
    .mobile-hr { display: block; }
    .primary-actions, .secondary-actions { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; width: 100%; }
  }
  @keyframes pmSlideDown { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }

  /* [8. 로딩 마스크 & 스피너] */
  .pm-global-mask { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255, 255, 255, 0.6); z-index: 99999; display: none; align-items: center; justify-content: center; flex-direction: column; }
  .pm-global-spinner { width: 50px; height: 50px; border: 5px solid #e2e8f0; border-top: 5px solid #2563eb; border-radius: 50%; animation: pmGlobalSpin 1s linear infinite; margin-bottom: 10px; }
  .pm-global-text { font-weight: 800; color: #2563eb; font-size: 16px; animation: pmPulse 1.5s ease-in-out infinite; }
  @keyframes pmGlobalSpin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
  @keyframes pmPulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.6; } }

  /* 통합 주석 관리자 모달 스타일 */
  .pm-modal-backdrop {
    position: fixed; inset: 0; background: rgba(15, 23, 42, 0.6);
    display: none; align-items: center; justify-content: center; z-index: 2000;
    backdrop-filter: blur(4px);
  }
  .pm-modal {
    width: 90%; max-width: 1200px; height: 85vh;
    background: #fff; border-radius: 16px; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    display: flex; overflow: hidden;
  }
  .pm-col-preview {
    flex: 2; background: #f8fafc; border-right: 1px solid #e2e8f0;
    display: flex; flex-direction: column;
  }
  .pm-col-edit {
    flex: 1; background: #fff; display: flex; flex-direction: column; min-width: 320px;
  }
  .pm-head {
    padding: 16px 20px; border-bottom: 1px solid #e2e8f0; font-weight: 800; font-size: 16px;
    background: #fff; display: flex; justify-content: space-between; align-items: center;
  }
  .pm-body { flex: 1; overflow-y: auto; padding: 20px; }
  .pm-foot {
    padding: 16px 20px; border-top: 1px solid #e2e8f0; background: #fff;
    display: flex; justify-content: flex-end; gap: 10px;
  }
  
  /* 미리보기 영역 스타일 (실제 블로그 느낌) */
  .blog-preview-content { font-family: sans-serif; line-height: 1.7; color: #334155; }
  .blog-preview-content h1, .blog-preview-content h2 { margin-top: 0; color: #0f172a; }
  .blog-preview-content p { margin-bottom: 1.5em; }
  .blog-preview-content .cheese-footnote-ref {
    color: #2563eb; text-decoration: none; font-size: 0.75em; vertical-align: super;
    font-weight: bold; cursor: pointer;
  }
  .blog-preview-content .cheese-footnotes {
    margin-top: 40px; padding-top: 20px; border-top: 1px solid #e2e8f0; font-size: 0.9em; color: #64748b;
  }
  
  /* 우측 에디터 아이템 스타일 */
  .fn-edit-item {
    background: #fff; border: 1px solid #cbd5e1; border-radius: 8px; padding: 12px; margin-bottom: 10px;
    transition: box-shadow 0.2s;
  }
  .fn-edit-item:focus-within { border-color: #3b82f6; box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1); }
  .fn-edit-header { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 12px; font-weight: bold; color: #475569; }
  .fn-edit-textarea {
    width: 100%; border: 1px solid #e2e8f0; border-radius: 6px; padding: 8px; font-size: 13px; line-height: 1.4;
    resize: vertical; min-height: 60px;
  }
  .fn-del-btn { color: #ef4444; cursor: pointer; text-decoration: underline; background: none; border: none; }

  /* [추가] 통합 모달 레이아웃 (좌: 에디터 / 우: 목록) */
.pm-modal-full {
  width: 95%; max-width: 1400px; height: 90vh;
  display: flex; overflow: hidden;
  background: #fff; border-radius: 16px;
  box-shadow: 0 20px 50px rgba(0,0,0,0.3);
}
.pm-pane-left {
  flex: 2; display: flex; flex-direction: column;
  border-right: 1px solid #e2e8f0; min-width: 0;
}
.pm-pane-right {
  width: 380px; background: #f8fafc;
  display: flex; flex-direction: column;
  border-left: 1px solid #e2e8f0;
}
.pm-pane-head {
  padding: 12px 20px; font-weight: 800; font-size: 15px; color: #1e293b;
  border-bottom: 1px solid #e2e8f0; background: #fff;
  display: flex; justify-content: space-between; align-items: center;
}
.pm-pane-body { flex: 1; overflow-y: auto; padding: 20px; position: relative; }
.pm-pane-foot {
  padding: 15px 20px; border-top: 1px solid #e2e8f0; background: #fff;
  text-align: right; display: flex; justify-content: flex-end; gap: 8px;
}

/* 탭 버튼 스타일 */
.pm-tabs { display: flex; background: #f1f5f9; padding: 4px; border-radius: 8px; gap: 4px; }
.pm-tab {
  padding: 6px 12px; border: none; background: none; font-size: 13px; font-weight: bold;
  color: #64748b; cursor: pointer; border-radius: 6px; transition: all 0.2s;
}
.pm-tab.active { background: #fff; color: #2563eb; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }

/* 에디터 스타일 */
.pm-editor-block { margin-bottom: 30px; position: relative; }
.pm-editor-label {
  display: inline-block; font-size: 11px; font-weight: bold; color: #94a3b8;
  margin-bottom: 5px; background: #f1f5f9; padding: 2px 6px; border-radius: 4px;
}
.pm-editor-textarea {
  width: 100%; min-height: 150px; padding: 15px;
  border: 1px solid #cbd5e1; border-radius: 8px;
  font-family: monospace; font-size: 14px; line-height: 1.6;
  outline: none; resize: vertical; transition: border 0.2s;
}
.pm-editor-textarea:focus { border-color: #3b82f6; box-shadow: 0 0 0 3px rgba(59,130,246,0.1); }

/* 우측 주석 리스트 아이템 */
.fn-live-item {
  background: #fff; border: 1px solid #e2e8f0; border-radius: 8px;
  padding: 12px; margin-bottom: 10px; transition: all 0.2s;
}
.fn-live-item:hover { border-color: #94a3b8; transform: translateY(-1px); }
.fn-live-head {
  display: flex; justify-content: space-between; font-size: 12px;
  font-weight: bold; color: #64748b; margin-bottom: 6px;
}
.fn-live-text {
  width: 100%; border: 1px solid #e2e8f0; background: #fafafa;
  padding: 8px; font-size: 13px; border-radius: 6px; resize: vertical; min-height: 60px;
}
.fn-live-text:focus { background: #fff; border-color: #3b82f6; outline: none; }
/* ====================================================
     ✨ 통합 미리보기 & 주석 정렬 모달창 개선 (레이아웃 & 스크롤)
     ==================================================== */

  /* 1. 개별 주석 텍스트 박스 높이 제한 및 스크롤 */
  .fn-live-text {
    min-height: 120px !important; /* ✅ 기본 높이를 키워서 처음부터 5~6줄이 보이게 설정 */
    max-height: 250px;            /* ✅ 최대 확장 높이도 넉넉하게 늘림 */
    overflow-y: auto !important;
  }

  /* 2. 통합 모달창 전용 커스텀 스크롤바 디자인 */
  .fn-live-text::-webkit-scrollbar,
  .pm-pane-body::-webkit-scrollbar,
  .pm-editor-textarea::-webkit-scrollbar {
    width: 6px;
  }
  .fn-live-text::-webkit-scrollbar-track,
  .pm-pane-body::-webkit-scrollbar-track,
  .pm-editor-textarea::-webkit-scrollbar-track {
    background: #f1f5f9;
    border-radius: 10px;
  }
  .fn-live-text::-webkit-scrollbar-thumb,
  .pm-pane-body::-webkit-scrollbar-thumb,
  .pm-editor-textarea::-webkit-scrollbar-thumb {
    background: #cbd5e1;
    border-radius: 10px;
  }
  .fn-live-text::-webkit-scrollbar-thumb:hover,
  .pm-pane-body::-webkit-scrollbar-thumb:hover,
  .pm-editor-textarea::-webkit-scrollbar-thumb:hover {
    background: #94a3b8;
  }

  /* 3. 모바일 환경에서 모달창 레이아웃 수정 (전체 스크롤로 통합) */
  @media (max-width: 768px) {
    .pm-modal-full {
      display: block !important; /* Flex 구조 해제 (내용물이 밀려나가는 현상 원천 차단) */
      height: 90vh !important;
      overflow-y: auto !important; /* ✨ 모달창 전체에 스크롤 허용 */
    }
    .pm-pane-left {
      display: block !important;
      border-right: none !important;
      border-bottom: 4px solid #e2e8f0; /* 본문과 주석 영역을 시각적으로 확실히 분리 */
    }
    .pm-pane-right {
      display: block !important;
      width: 100% !important;
      border-left: none !important;
    }
    .pm-pane-body {
      /* 이중 스크롤(스크롤 지옥) 방지: 내부 스크롤을 끄고 내용물 길이만큼 자연스럽게 늘어나게 둠 */
      overflow: visible !important;
      height: auto !important;
    }
    /* ✅ 하단 [적용하기] 버튼을 화면 아래쪽에 항상 떠 있게 고정 */
    .pm-pane-foot {
      position: sticky;
      bottom: 0;
      z-index: 50;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(5px);
      box-shadow: 0 -4px 15px rgba(0,0,0,0.08);
    }
  }
</style>
